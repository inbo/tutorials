<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>INBO style guide for R code</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/default.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">INBO tutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Software installation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="installation-R-admin.html">R as admin</a>
    </li>
    <li>
      <a href="installation-R-user.html">R as user</a>
    </li>
    <li>
      <a href="installation-RStudio-admin.html">RStudio as admin</a>
    </li>
    <li>
      <a href="installation-RStudio-user.html">RStudio as user</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Software development
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="development-styleguide-repos.html">Repository style guide</a>
    </li>
    <li>
      <a href="development-styleguide-R.html">R style guide</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">INBO style guide for R code</h1>

</div>


<div id="scope" class="section level1">
<h1>Scope</h1>
<p>This style guide applies to all R code where INBO is copyright holder. It is mandatory for all new projects intended to be distributed and highly recommended for all other projects. It doesn’t apply to existing projects, except when revising such project. Then the style guide applies to the revised parts of the code.</p>
</div>
<div id="recommended-packages" class="section level1">
<h1>Recommended packages</h1>
<div id="data-import" class="section level2">
<h2>Data import</h2>
<dl>
<dt><code>readr</code></dt>
<dd>text files
</dd>
<dt><code>readexcel</code></dt>
<dd>Excel files
</dd>
<dt><code>googlesheets</code></dt>
<dd>googlesheets
</dd>
<dt><code>DBI</code></dt>
<dd>connections to databases: PostgreSQL, SQLite, MySQL, Oracle, …
</dd>
<dt><code>RODBC</code></dt>
<dd>connections to SQL Server, Access
</dd>
</dl>
</div>
<div id="data-manipulation-and-transformation" class="section level2">
<h2>Data manipulation and transformation</h2>
<dl>
<dt><code>dplyr</code></dt>
<dd>subsetting observations
</dd>
<dd>subsetting variables
</dd>
<dd>changing variables
</dd>
<dd>aggregation
</dd>
<dd>combining dataframes
</dd>
<dt><code>tidyr</code></dt>
<dd>changing a dataframe for wide to long format and vice versa
</dd>
<dd>nesting and unnesting dataframes
</dd>
<dd>splitting a single variable into multiple variables
</dd>
</dl>
</div>
<div id="graphics" class="section level2">
<h2>Graphics</h2>
<dl>
<dt><code>ggplot2</code></dt>
<dd>all static graphics
</dd>
<dt><code>INBOtheme</code></dt>
<dd>INBO corporate identity for <code>ggplot2</code> graphics
</dd>
</dl>
</div>
<div id="quality-control" class="section level2">
<h2>Quality control</h2>
<dl>
<dt><code>lintr</code></dt>
<dd>checking coding style
</dd>
<dt><code>testthat</code></dt>
<dd>writing unit tests
</dd>
<dt><code>covr</code></dt>
<dd>check which part of the code is not covered by unit tests
</dd>
</dl>
</div>
</div>
<div id="syntax" class="section level1">
<h1>Syntax</h1>
<p><strong>RStudio hint</strong>: <em>Tools</em> -&gt; <em>Global options</em> -&gt; <em>Code</em> -&gt; <em>Diagnotics</em> -&gt; Check everything</p>
<div id="general" class="section level2">
<h2>General</h2>
<ul>
<li>lines should not exceed 80 characters
<ul>
<li>split the command over multiple lines if the command is longer than 80 characters</li>
<li><strong>RStudio hint</strong>: <em>Tools</em> -&gt; <em>Global options</em> -&gt; <em>Code</em> -&gt; <em>Display</em> -&gt; Check <em>Show margin</em> and set <em>Margin column</em> to 80</li>
</ul></li>
<li>object names should be meaningful</li>
<li>object names should not exceed 20 characters</li>
<li>object names should lowercase</li>
<li>use <code>_</code> to separate words in object names
<ul>
<li>function names with a single dot are allowed</li>
</ul></li>
<li>use single quotes (<code>'</code>) around characters and not double quotes (<code>&quot;</code>)</li>
<li>don’t add commented code
<ul>
<li>use version control is you want to keep old versions of code</li>
</ul></li>
</ul>
<pre class="r"><code># Good
example_text &lt;- example_function(
  first_argument = &#39;Some text&#39;, 
  second_argument = &#39;More text&#39;
)

# Wrong
some.really.long.dot.separated.name &lt;- MyCoolFunction(FirstArgument = &quot;Some text&quot;, second.argument = &quot;More text&quot;)</code></pre>
</div>
<div id="whitespace" class="section level2">
<h2>Whitespace</h2>
<ul>
<li>don’t use tabs, use two spaces instead
<ul>
<li><strong>RStudio hint</strong>: <em>Tools</em> -&gt; <em>Global options</em> -&gt; <em>Code</em> -&gt; <em>Editing</em> -&gt; Check <em>Insert spaces for tab</em> and set <em>Tab width</em> to 2</li>
</ul></li>
<li>no space before a comma, one space after a comma</li>
<li>one space before and after an infix operator (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code>, <code>&amp;</code>, <code>|</code>, <code>%%</code>, <code>%/%</code>, <code>%*%</code>, <code>%in%</code>, …)</li>
<li>no spaces a the end of a line
<ul>
<li><strong>RStudio hint</strong>: <em>Tools</em> -&gt; <em>Global options</em> -&gt; <em>Code</em> -&gt; <em>Saving</em> -&gt; Check <em>Strip trailing horizontal whitespace when saving</em></li>
</ul></li>
<li>the script file end with a single blank line
<ul>
<li><strong>RStudio hint</strong>: <em>Tools</em> -&gt; <em>Global options</em> -&gt; <em>Code</em> -&gt; <em>Saving</em> -&gt; Check <em>Ensure that source files end with newline</em></li>
</ul></li>
</ul>
</div>
<div id="assignments" class="section level2">
<h2>Assignments</h2>
<ul>
<li>only create an object when you will use it later on</li>
<li>always use <code>&lt;-</code> for assignment</li>
<li>use <code>=</code> only for passing arguments in a function</li>
<li>one space before and one space after <code>&lt;-</code> and <code>=</code></li>
</ul>
<pre class="r"><code># Good
x &lt;- data.frame(z = 1:10)
summary(x)

# Wrong
x=data.frame(z&lt;-1:10)</code></pre>
</div>
<div id="brackets" class="section level2">
<h2>Brackets</h2>
<p>R uses three types of brackets: round <code>(</code>, <code>)</code>, square <code>[</code>, <code>]</code> and curly <code>{</code>, <code>}</code>.</p>
<ul>
<li>no spaces after opening a bracket</li>
<li>no spaces before closing a bracket</li>
<li>no spaces before opening a bracket except:
<ul>
<li>one space with control flow functions (<code>if</code>, <code>else</code>, <code>for</code>, <code>while</code>)</li>
</ul></li>
<li>no spaces after closing a bracket except:
<ul>
<li>one space with control flow functions (<code>if</code>, <code>else</code>, <code>for</code>, <code>while</code>)</li>
</ul></li>
<li><code>{</code> should not start on a newline and is always the end of a line</li>
<li>apply indentation when splitting long text inside brackets over multiple lines</li>
</ul>
<pre class="r"><code># Good
y &lt;- seq(0, 2)
if (max(y) &lt;= 10) {
  x &lt;- 1
} else {
  x &lt;- 2
}
sapply(
  y, 
  function(x){
    return(x)
  }
)

# Wrong
y &lt;- seq (0, 2   )
if(   max( y ) &lt;= 10    )        
{ x &lt;- 1 } else 
{ x &lt;- 2 }
sapply( y , function ( x ) { return(x)})</code></pre>
</div>
<div id="special-cases-and-exceptions" class="section level2">
<h2>Special cases and exceptions</h2>
<ul>
<li>selecting rows with square brackets <code>df[selection, ]</code>
<ul>
<li>this results in two conflicting rules
<ol style="list-style-type: decimal">
<li>a single space after a comma</li>
<li>no space before a bracket</li>
</ol></li>
<li>solution in case of a short command: add <code># nolint</code> after the command
<ul>
<li><code>df[selection, ] # nolint</code></li>
</ul></li>
<li>solution in case of a long command: split the command over several lines</li>
</ul></li>
</ul>
<pre class="r"><code># Good
relevant_subset &lt;- original_dataframe[
  original_dataframe$x &gt; some_value | original_dataframe$y &lt; some_other_value, 
]
# Recommended dplyr alternative
relevant_subset &lt;- original_dataframe %&gt;%
  filter(x &gt; some_value | y &lt; some_other_value)

# Wrong
relevant_subset &lt;- original_dataframe[original_dataframe$x &gt; some_value | original_dataframe$y &lt; some_other_value, ] # nolint</code></pre>
<ul>
<li>a really long text
<ul>
<li>text shorter than 80 characters but passed the 80 character limit due to the indentitation
<ul>
<li>solution: remove all indentation</li>
</ul></li>
<li>text longer than 80 characters
<ul>
<li>solution: add <code># nolint</code> at the end of the line</li>
</ul></li>
</ul></li>
<li>functions from other packages with names that don’t comply with this style guide
<ul>
<li>solution: add <code># nolint</code> at the end of the line</li>
</ul></li>
</ul>
<p><strong>Important notice</strong></p>
<p>Adding <code># nolint</code> at the end of a line excludes that line from the automatic checks for coding styles. Therefore use it only when you have no other options.</p>
</div>
</div>
<div id="documentation" class="section level1">
<h1>Documentation</h1>
<div id="functions" class="section level2">
<h2>Functions</h2>
<ul>
<li>Add documentation above each function with <code>Roxygen</code> markup</li>
<li>Add inline comments where relevant</li>
</ul>
</div>
<div id="how-tos" class="section level2">
<h2>How-to’s</h2>
<ul>
<li>Add one or more how-to’s to a package</li>
<li>Add them as RMarkdown vignettes</li>
</ul>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
