<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='This style guide is a recommendation for all R code written for the Research Institute for Nature and Forest (INBO). The goal of this style guide is twofold. First of all applying the guidelines will result in readable code. Secondly, it is much easier to work together on code when everyone is using the same guidelines.'>
<meta name='theme-color' content='#c04384'>

<meta property='og:title' content='Styleguide R code • INBO Tutorials'>
<meta property='og:description' content='This style guide is a recommendation for all R code written for the Research Institute for Nature and Forest (INBO). The goal of this style guide is twofold. First of all applying the guidelines will result in readable code. Secondly, it is much easier to work together on code when everyone is using the same guidelines.'>
<meta property='og:url' content='https://inbo.github.io/tutorials/styleguide_r_code/'>
<meta property='og:site_name' content='INBO Tutorials'>
<meta property='og:type' content='article'><meta property='article:section' content='tutorials'><meta property='article:tag' content='styleguide'><meta property='article:tag' content='r'><meta property='article:published_time' content='2017-10-18T16:01:34&#43;02:00'/><meta property='article:modified_time' content='2017-10-18T16:01:34&#43;02:00'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.53-DEV" />

  <title>Styleguide R code • INBO Tutorials</title>
  <link rel='canonical' href='https://inbo.github.io/tutorials/styleguide_r_code/'>
  
  
  <link rel='icon' href='../../favicon.ico'>
<link rel='stylesheet' href='../../assets/css/main.4a10984a.css'><link rel='stylesheet' href='../../css/custom.css'><style>
:root{--color-accent:#c04384;}
</style>

  

</head>
<body class='page type-tutorials has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='../../'>
        <img src='../../images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
     
    </h2>
    <div class='desc'>
    
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'>Search</h4>
  </header>

  <form action='/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='../../'>Home</a></li><li class='item'>
  <a href='../../articles/'>articles</a></li><li class='item'>
  <a href='../../tutorials/'>tutorials</a></li><li class='item'>
  <a href='../../create_tutorial/'>Create tutorial</a></li><li class='item has-children'>
  <a href='../../installation/'>installation</a><button class='sub-menu-toggler'>
    <span class='screen-reader-text'>expand sub menu</span>
    <span class='sign'></span>
  </button>

  <ul class='sub-menu'><li class='item'>
  <a href='../../installation/administrator/'>administrator</a></li><li class='item'>
  <a href='../../installation/user/'>user</a></li></ul></li></ul>
    </div>
  </nav>

</section><section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud'><li>
        <a href='../../tags/api/' style='font-size:1em'>API</a>
      </li><li>
        <a href='../../tags/biodiversity/' style='font-size:1em'>biodiversity</a>
      </li><li>
        <a href='../../tags/ci/' style='font-size:1.0588235294117647em'>ci</a>
      </li><li>
        <a href='../../tags/data/' style='font-size:1em'>data</a>
      </li><li>
        <a href='../../tags/database/' style='font-size:1em'>database</a>
      </li><li>
        <a href='../../tags/development/' style='font-size:1.0588235294117647em'>development</a>
      </li><li>
        <a href='../../tags/gbif/' style='font-size:1em'>gbif</a>
      </li><li>
        <a href='../../tags/gis/' style='font-size:1.1764705882352942em'>gis</a>
      </li><li>
        <a href='../../tags/git/' style='font-size:1.2941176470588236em'>git</a>
      </li><li>
        <a href='../../tags/github/' style='font-size:1em'>github</a>
      </li><li>
        <a href='../../tags/google/' style='font-size:1.0588235294117647em'>google</a>
      </li><li>
        <a href='../../tags/installation/' style='font-size:1.4705882352941178em'>installation</a>
      </li><li>
        <a href='../../tags/literature/' style='font-size:1.2352941176470589em'>literature</a>
      </li><li>
        <a href='../../tags/maps/' style='font-size:1.1764705882352942em'>maps</a>
      </li><li>
        <a href='../../tags/markdown/' style='font-size:1em'>markdown</a>
      </li><li>
        <a href='../../tags/open-science/' style='font-size:1.2352941176470589em'>open science</a>
      </li><li>
        <a href='../../tags/packages/' style='font-size:1.0588235294117647em'>packages</a>
      </li><li>
        <a href='../../tags/pandoc/' style='font-size:1em'>pandoc</a>
      </li><li>
        <a href='../../tags/r/' style='font-size:2em'>r</a>
      </li><li>
        <a href='../../tags/rstudio/' style='font-size:1.0588235294117647em'>rstudio</a>
      </li><li>
        <a href='../../tags/spreadsheet/' style='font-size:1em'>spreadsheet</a>
      </li><li>
        <a href='../../tags/styleguide/' style='font-size:1.0588235294117647em'>styleguide</a>
      </li><li>
        <a href='../../tags/tidyverse/' style='font-size:1.1764705882352942em'>tidyverse</a>
      </li><li>
        <a href='../../tags/version-control/' style='font-size:1.2352941176470589em'>version control</a>
      </li><li>
        <a href='../../tags/webservice/' style='font-size:1.1176470588235294em'>webservice</a>
      </li><li>
        <a href='../../tags/windows/' style='font-size:1em'>windows</a>
      </li></ul>
</div>


</section>
</div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    <a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button>
    <ul><li class='item'>
        <a href='../../'>Home</a>
      </li><li class='item'>
        <a href='../../articles/'>articles</a>
      </li><li class='item'>
        <a href='../../tutorials/'>tutorials</a>
      </li><li class='item'>
        <a href='https://github.com/inbo/tutorials'>Source</a>
      </li><li class='item'>
        <a href='../../categories/'>Categories</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'>
    
    <style>.widget-breadcrumbs li:after{content:'\2f '}</style>
  <section class='widget widget-breadcrumbs sep-after'>
    <nav id='breadcrumbs'>
      <ol><li><a href='../../'>Home</a></li><li><a href='../../tutorials/'>tutorials</a></li><li><span>Styleguide R code</span></li></ol>
    </nav>
  </section></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>INBO Tutorials</p><p class='desc site-desc'>Technical info about INBO</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Styleguide R code</h1>
      
<p class='desc'>This style guide is a recommendation for all R code written for the Research Institute for Nature and Forest (INBO). The goal of this style guide is twofold. First of all applying the guidelines will result in readable code. Secondly, it is much easier to work together on code when everyone is using the same guidelines.</p>


    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2017-10-18T16:01:34&#43;02:00'>2017, Oct 18</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
10 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  

<h2 id="scope">Scope</h2>

<p>This style guide is a recommendation for all R code written for the Research Institute for Nature and Forest (INBO). The goal of this style guide is twofold. First of all applying the guidelines will result in readable code. Secondly, it is much easier to work together on code when everyone is using the same guidelines. It is likely that applying these guidelines will have consequences on the current style used by many R users at INBO. Therefore this style guide should be applied within reason.</p>

<ol>
<li>Don&rsquo;t apply the style guide to existing code.</li>
<li>R users are free to apply the style guide to new personal R code.</li>
<li>Using the style guide is highly recommended for new or revised R code intended to be distributed and used by other R users.</li>
<li>The style guide is mandatory for new or revised R packages distributed by INBO.</li>
</ol>

<p>Please note that the RStudio editor has some handy features that automatically highlights errors against the code style in a non intrusive way. <strong>RStudio hints</strong> in this document are the instructions to activate these diagnostics in RStudio.</p>

<h2 id="syntax">Syntax</h2>

<p><strong>RStudio hint</strong>: <em>Tools &gt; Global options &gt; Code &gt; Diagnotics</em>: Check everything</p>

<h3 id="general">General</h3>

<ul>
<li>lines should not exceed 80 characters

<ul>
<li>split the command over multiple lines if the command is longer than 80 characters</li>
<li><strong>RStudio hint</strong>: <em>Tools &gt; Global options &gt; Code &gt; Display</em>: Check <em>Show margin</em> and set <em>Margin column</em> to 80</li>
</ul></li>
<li>object names should be meaningful</li>
<li>object names should not exceed 20 characters</li>
<li>object names should be lowercase</li>
<li>use <code>_</code> to separate words in object names

<ul>
<li>function names with a single dot are allowed</li>
</ul></li>
<li>use double quotes (<code>&quot;</code>) around characters and not single quotes (<code>'</code>)</li>
<li>don&rsquo;t add commented code

<ul>
<li>use version control if you want to keep old versions of code</li>
</ul></li>
</ul>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic"># Good</span>
example_text &lt;- example_function(
  first_argument = <span style="color:#a50">&#34;Some text&#34;</span>,
  second_argument = <span style="color:#a50">&#34;More text&#34;</span>
)

<span style="color:#aaa;font-style:italic"># Bad</span>
some.really.long.dot.separated.name &lt;- MyCoolFunction(FirstArgument = <span style="color:#a50">&#39;Some text&#39;</span>, second.argument = <span style="color:#a50">&#39;More text&#39;</span>)</code></pre></div>
<h3 id="whitespace">Whitespace</h3>

<p>naturallanguagesusewhitespaceandpunctuationtomaketextsmorereadableprogramminglanguagesarenoexceptiontothisrule</p>

<p>Natural languages use whitespace and punctuation to make texts more readable. Programming languages are no exception to this rule.</p>

<ul>
<li>don&rsquo;t use tabs, use two spaces instead

<ul>
<li><strong>RStudio hint</strong>: <em>Tools &gt; Global options &gt; Code &gt; Editing</em>: Check <em>Insert spaces for tab</em> and set <em>Tab width</em> to 2</li>
</ul></li>
<li>no space before a comma, one space after a comma</li>
<li>one space before and after an infix operator (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code>, <code>&amp;</code>, <code>|</code>, <code>%%</code>, <code>%/%</code>, <code>%*%</code>, <code>%in%</code>, &hellip;)</li>
<li>no spaces a the end of a line

<ul>
<li><strong>RStudio hint</strong>: <em>Tools &gt; Global options &gt; Code &gt; Saving</em>: Check <em>Strip trailing horizontal whitespace when saving</em></li>
</ul></li>
<li>end the script file with a single blank line

<ul>
<li><strong>RStudio hint</strong>: <em>Tools &gt; Global options &gt; Code &gt; Saving</em>: Check <em>Ensure that source files end with newline</em></li>
</ul></li>
</ul>

<h3 id="assignments">Assignments</h3>

<ul>
<li>only create an object when you will use it later on</li>
<li>always use <code>&lt;-</code> for assignment</li>
<li>use <code>=</code> only for passing arguments in a function</li>
<li>at least one space before and at least one space after <code>&lt;-</code> and <code>=</code>

<ul>
<li>use multiple spaces if it improves readability</li>
</ul></li>
</ul>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic"># Good</span>
x &lt;- <span style="color:#0aa">data.frame</span>(z = <span style="color:#099">1</span>:<span style="color:#099">10</span>)
<span style="color:#00a">summary</span>(x)

<span style="color:#aaa;font-style:italic"># Bad</span>
x=<span style="color:#0aa">data.frame</span>(z&lt;-<span style="color:#099">1</span>:<span style="color:#099">10</span>)

<span style="color:#aaa;font-style:italic"># Improved readability example</span>
a   &lt;-   <span style="color:#099">5</span>
ab  &lt;-  <span style="color:#099">10</span>
abc &lt;-   <span style="color:#099">7</span>
d   &lt;- <span style="color:#099">245</span></code></pre></div>
<h3 id="brackets">Brackets</h3>

<p>R uses three types of brackets: round <code>(...)</code>, square <code>[...]</code> and curly <code>{...}</code>.</p>

<ul>
<li>no spaces after opening a bracket</li>
<li>no spaces before closing a bracket</li>
<li>no spaces before opening a bracket except:

<ul>
<li>one space with control flow functions (<code>if</code>, <code>else</code>, <code>for</code>, <code>while</code>)</li>
</ul></li>
<li>no spaces after closing a bracket except:

<ul>
<li>one space with control flow functions (<code>if</code>, <code>else</code>, <code>for</code>, <code>while</code>)</li>
</ul></li>
<li><code>{</code> should not start on a newline and is always the end of a line</li>
<li>apply indentation when splitting long text inside brackets over multiple lines</li>
</ul>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic"># Good</span>
y &lt;- <span style="color:#00a">seq</span>(<span style="color:#099">0</span>, <span style="color:#099">2</span>)
<span style="color:#00a">if</span> (<span style="color:#00a">max</span>(y) &lt;= <span style="color:#099">10</span>) {
  x &lt;- <span style="color:#099">1</span>
} <span style="color:#00a">else</span> {
  x &lt;- <span style="color:#099">2</span>
}
<span style="color:#00a">sapply</span>(
  y,
  <span style="color:#00a">function</span>(x){
    <span style="color:#00a">return</span>(x)
  }
)

<span style="color:#aaa;font-style:italic"># Bad</span>
y &lt;- seq (<span style="color:#099">0</span>, <span style="color:#099">2</span>   )
<span style="color:#00a">if</span>(   <span style="color:#00a">max</span>( y ) &lt;= <span style="color:#099">10</span>    )        
{ x &lt;- <span style="color:#099">1</span> } <span style="color:#00a">else</span> 
{ x &lt;- <span style="color:#099">2</span> }
<span style="color:#00a">sapply</span>( y , <span style="color:#00a">function</span> ( x ) { <span style="color:#00a">return</span>(x)})</code></pre></div>
<h3 id="special-cases-and-exceptions">Special cases and exceptions</h3>

<ul>
<li>selecting rows with square brackets <code>df[selection, ]</code>

<ul>
<li>this results in two conflicting rules

<ol>
<li>a single space after a comma</li>
<li>no space before a bracket</li>
</ol></li>
<li>solution in case of a short command: add <code># nolint</code> after the command

<ul>
<li><code>df[selection, ] # nolint</code></li>
</ul></li>
<li>solution in case of a long command: split the command over several lines</li>
</ul></li>
</ul>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic"># Good</span>
relevant_subset &lt;- original_dataframe[
  original_dataframe$x &gt; some_value | original_dataframe$y &lt; some_other_value,
]
<span style="color:#aaa;font-style:italic"># Recommended dplyr alternative</span>
relevant_subset &lt;- original_dataframe %&gt;%
  filter(x &gt; some_value | y &lt; some_other_value)

<span style="color:#aaa;font-style:italic"># Bad</span>
relevant_subset &lt;- original_dataframe[original_dataframe$x &gt; some_value | original_dataframe$y &lt; some_other_value, ] <span style="color:#aaa;font-style:italic"># nolint</span></code></pre></div>
<ul>
<li>a really long text

<ul>
<li>text shorter than 80 characters but passed the 80 character limit due to the indentitation

<ul>
<li>solution: remove all indentation</li>
</ul></li>
<li>text longer than 80 characters

<ul>
<li>solution: add <code># nolint</code> at the end of the line</li>
</ul></li>
</ul></li>
<li>functions from other packages with names that don&rsquo;t comply with this style guide

<ul>
<li>solution: add <code># nolint</code> at the end of the line</li>
</ul></li>
</ul>

<p><strong>Important notice</strong></p>

<p>Adding <code># nolint</code> at the end of a line excludes that line from the automatic checks for coding styles. Therefore use it only when you have no other options.</p>

<h3 id="validating-syntax">Validating syntax</h3>

<p>The code below validate the syntax for an R file, an RMarkdown file or an R package.</p>

<p><strong>RStudio hint</strong>: Running this code within RStudio will open a <em>Markers</em> pane, indicating the filename, line number and the kind of syntax error that occurs. Double clicking on the error will open the file a the correct location, making it easy to rectify the problem.</p>

<p>Extra hint: start correcting for the last lines and work your way forward. This leave the line numbers of the errors intact until you solve them.</p>

<p>An example to clarify this. Suppose you have an error at line 10 and an error at line 100. Both errors are <code>lines should not be more than 80 characters</code>, so to solve them we have to split the lines over multiple lines.</p>

<p>Let say that we start with solving line 10 by splitting it over four lines. So the old line 10 becomes the new lines 10 to 13. Hence the old line 11 becomes the new line 14, and the old line 100 becomes the new line 103. When we now click on the marker for line 100, RStudio will go the current line 100 which is the old line 97. So you end up looking for an error at the wrong position.</p>

<p>Starting at the back solved this issue. In the same example we would start by solving line 100. Let&rsquo;s assume we split this over two lines. So old line 100 because new line 100 and 101. Old line 101 becomes new line 102 but more importantly <strong>all line numbers before 100 are unchanged</strong>. So clicking on the marker for line 10 will take you the current line 10 which is the old line 10.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic"># validate a single file</span>
lintr::lint(filename = <span style="color:#a50">&#34;file.R&#34;</span>)
lintr::lint(filename = <span style="color:#a50">&#34;file.Rmd&#34;</span>)

<span style="color:#aaa;font-style:italic"># validate a package</span>
lintr::lint_package(path = <span style="color:#a50">&#34;.&#34;</span>)</code></pre></div>
<h2 id="documentation">Documentation</h2>

<h3 id="functions">Functions</h3>

<ul>
<li>Add documentation above each function with <code>Roxygen</code> markup</li>
<li>Add inline comments where relevant</li>
</ul>

<h4 id="required-roxygen-tags">Required Roxygen tags</h4>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic">#&#39; @title Title of the helpfile</span>
<span style="color:#aaa;font-style:italic">#&#39; @description Description of the function in the helpfile</span>
<span style="color:#aaa;font-style:italic">#&#39; @param define a parameter</span>
<span style="color:#aaa;font-style:italic">#&#39; @export is the function exported by the package NAMESPACE</span>
<span style="color:#aaa;font-style:italic">#&#39; @importFrom import a function from another package</span></code></pre></div>
<h4 id="optional-roxygen-tags">Optional Roxygen tags</h4>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic">#&#39; @seealso link to other functions</span>
<span style="color:#aaa;font-style:italic">#&#39; @section section title</span>
<span style="color:#aaa;font-style:italic">#&#39; @alias other name for the topic</span>
<span style="color:#aaa;font-style:italic">#&#39; @keywords a set of standardised keywords. See file.path(R.home(&#34;doc&#34;), &#34;KEYWORDS&#34;)</span>
<span style="color:#aaa;font-style:italic">#&#39; @inheritParams inherit the definition of parameters from another function</span>
<span style="color:#aaa;font-style:italic">#&#39; @examples a working example of the function</span>
<span style="color:#aaa;font-style:italic">#&#39; @return a description of the output from the function</span></code></pre></div>
<p>See <a href="http://r-pkgs.had.co.nz/man.html#roxygen-comments" target="_blank">http://r-pkgs.had.co.nz/man.html#roxygen-comments</a> for more information on Roxygen</p>

<h4 id="inbo-extra-requirements-for-package-description">INBO extra requirements for package DESCRIPTION</h4>

<ul>
<li>license: MIT or GPL-3? In case of MIT a LICENSE file should be added and <code>License: MIT</code> to the DESCRIPTION. In case of GPL-3 it is sufficient to add <code>License: GPL-3</code> to the DESCRIPTION</li>
<li>list of authors in <code>Authors@R</code> format</li>
<li>INBO is listed as copyright holder</li>
<li>one or more roles are atributed to each person

<ul>
<li><code>cre</code>: package maintainer (only one person)</li>
<li><code>aut</code>: main author (at least one person)</li>
<li><code>ctb</code>: contributor (if relevant)</li>
<li><code>cph</code>: copyright holder (must be INBO)</li>
</ul></li>
</ul>

<p><a href="mailto:Authors@R" target="_blank">Authors@R</a>: c(person(&ldquo;Els&rdquo;, &ldquo;Lommelen&rdquo;, email = &ldquo;<a href="mailto:els.lommelen@inbo.be" target="_blank">els.lommelen@inbo.be</a>&rdquo;, role = c(&ldquo;aut&rdquo;, &ldquo;cre&rdquo;)), person(&ldquo;Thierry&rdquo;, &ldquo;Onkelinx&rdquo;, email = &ldquo;<a href="mailto:thierry.onkelinx@inbo.be" target="_blank">thierry.onkelinx@inbo.be</a>&rdquo;, role = &ldquo;aut&rdquo;), person(&ldquo;Anja&rdquo;, &ldquo;Leyman&rdquo;, email = &ldquo;<a href="mailto:anja.leyman@inbo.be" target="_blank">anja.leyman@inbo.be</a>&rdquo;, role = &ldquo;ctb&rdquo;), person(family = &ldquo;Research Institute for Nature and Forest (INBO)&rdquo;, email = &ldquo;<a href="mailto:info@inbo.be" target="_blank">info@inbo.be</a>&rdquo;, role = &ldquo;cph&rdquo;))</p>

<h3 id="how-to-s">How-to&rsquo;s</h3>

<ul>
<li>Add one or more how-to&rsquo;s to a package</li>
<li>Add them as RMarkdown vignettes</li>
</ul>

<h2 id="file-structure">File structure</h2>

<h3 id="r-package">R Package</h3>

<h4 id="functions-1">Functions</h4>

<ul>
<li>all generic R functions should be distributed as an R package</li>
<li>use <code>devtools::create()</code> to start a new pacakge

<ul>
<li><strong>RStudio hint</strong>: <em>File &gt; New project &gt; New directory &gt; R Package</em>: Type the name in <em>Package name</em></li>
</ul></li>
<li>keep source files compact

<ul>
<li>create a separate file for each function, with the file name equal to the function name. This makes it easy to find the correct source file.</li>
<li>exception: very short auxilary functions with related functionality

<ul>
<li>related functions can be bundled into one R script</li>
<li>file name is either equal to the most important function or describes the related functionality</li>
</ul></li>
</ul></li>
<li>split large functions into several subfunctions</li>
</ul>

<h4 id="scripts">Scripts</h4>

<ul>
<li>place scripts in the <code>inst</code> folder

<ul>
<li>the scripts will be available for the user after installing the package</li>
<li>the location of the scripts can be found with <code>system.file(&quot;script-name.R&quot;, package = &quot;yourpackage&quot;)</code></li>
<li>use a relevant folder structure when adding lots of files to <code>inst</code></li>
</ul></li>
</ul>

<h4 id="unit-tests">Unit tests</h4>

<ul>
<li>use the <code>testthat</code> package for unit tests

<ul>
<li>use <code>devtools::use_testthat()</code> to setup the test infrastructure</li>
</ul></li>
<li>all unit tests are stored in <code>tests/testthat</code></li>
<li>all files should have either a <code>test_</code> or <code>helper_</code> prefix

<ul>
<li>files with <code>helper_</code> prefix contain auxiliary function for the tests but no tests</li>
</ul></li>
<li>the test files will be run in alphabetical order

<ul>
<li>setting the order of the files is easy by adding 3 letters to the prefix (eg. <code>test_aaa_</code>, <code>test_baa</code>, <code>test_zzz_</code>)</li>
<li>3 letters offers quite some flexibility to insert new files at the correct location without having to rename at lot of files. If the first file is <code>test_aaa_</code> and the second <code>test_baa</code>, they you can 675 files between the two.</li>
</ul></li>
<li>unit test files can be larger than source files</li>
<li>a unit test file can contain tests for several functions in case the functions are strongly related (e.g. subfunctions) and reuse test cases</li>
<li>each package should contain the unit for coding style as listed below

<ul>
<li>store this in a file <code>tests/testthat/test_zzz_coding_style.R</code></li>
<li>add this file to <code>.gitignore</code>

<ul>
<li>the coding style will be tested separatly when using continuous integration</li>
</ul></li>
</ul></li>
</ul>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#00a">if</span> (<span style="color:#00a">requireNamespace</span>(<span style="color:#a50">&#34;lintr&#34;</span>, quietly = <span style="color:#00a">TRUE</span>)) {
  context(<span style="color:#a50">&#34;lints&#34;</span>)
  test_that(<span style="color:#a50">&#34;Package Style&#34;</span>, {
    lintr::expect_lint_free()
  })
}</code></pre></div>
<h3 id="r-script">R script</h3>

<ul>
<li>group a long set of commands with similar functionality into a dedicated function

<ul>
<li>e.g. <code>prepare_data()</code>, <code>do_analysis()</code>, <code>create_figure()</code>, &hellip;</li>
</ul></li>
<li>place the user defined functions in a separate file which you <code>source()</code> into the main script

<ul>
<li>it is better to use the same file structure as an R package</li>
<li>consider writing a simple package in case you have a lot of functions</li>
</ul></li>
</ul>

<h3 id="rmarkdown">RMarkdown</h3>

<ul>
<li>each chunk has only one output (figure, table, summary, &hellip;)</li>
<li>don&rsquo;t mix (heavy) calculations and output in the same chunk: this is more interesting for caching the results</li>
<li>give chunks a relevant name: this make debugging easier and file name of figures and Bookdown label will be based on the chunk name</li>
<li>avoid writing code that generates Markdown

<ul>
<li>use (parametrised) child documents instead</li>
</ul></li>
<li>use the bookdown version for long reports: this makes it easy to split a long report into several child documents</li>
</ul>

<h2 id="recommended-packages">Recommended packages</h2>

<h3 id="data-import">Data import</h3>

<ul>
<li><code>readr</code>: import text files</li>
<li><code>readxl</code>: import Excel files</li>
<li><code>googlesheets</code>: import Google Sheets</li>
<li><code>DBI</code>: connect to databases PostgreSQL, SQLite, MySQL, Oracle, &hellip;</li>
<li><code>RODBC</code>: connect to databases SQL Server, Access</li>
</ul>

<h3 id="data-manipulation-transformation">Data manipulation &amp; transformation</h3>

<ul>
<li><code>dplyr</code>:

<ul>
<li>subsetting observations</li>
<li>subsetting variables</li>
<li>changing variables</li>
<li>aggregation</li>
<li>combining dataframes</li>
</ul></li>
<li><code>tidyr</code>:

<ul>
<li>changing a dataframe from wide to long format and vice versa</li>
<li>nesting and unnesting dataframes</li>
<li>splitting a single variable into multiple variables</li>
</ul></li>
</ul>

<h3 id="graphics">Graphics</h3>

<ul>
<li><code>ggplot2</code>:all static graphics, charts and plots</li>
<li><code>INBOtheme</code>: INBO corporate identity for <code>ggplot2</code> graphics</li>
</ul>

<h3 id="quality-control">Quality control</h3>

<ul>
<li><code>lintr</code>: checking coding style</li>
<li><code>testthat</code>: writing unit tests</li>
<li><code>covr</code>: check which part of the code is not covered by unit tests</li>
</ul>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
<span class='screen-reader-text'>Categories: </span><a class='category' href='../../categories/styleguide/'>styleguide</a></div>
<div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='../../tags/styleguide/'>styleguide</a>, <a class='tag' href='../../tags/r/'>r</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='../../tutorials/git_undo_commit/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Undo a git commit</a>
    </div><div class='next-entry sep-before'>
      <a href='../../tutorials/styleguide_repos/'>
        <span class='screen-reader-text'>Next post: </span>Styleguide new git repositories<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/inbo' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://facebook.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Facebook account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/inbovlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section><div class='copyright'>
  <p> &copy; 2018 Institute of Nature and Forest research </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__public_path__='\/assets\/js\/'</script>

<script src='../../assets/js/main.fae8ed32.js'></script><script src='../../js/custom.js'></script>

</body>

</html>

