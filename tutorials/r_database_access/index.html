<!DOCTYPE html>
<html lang='en' dir='auto'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Database access using R'>
<meta name='theme-color' content='#c04384'>

<meta property='og:title' content='Read data from INBO databases (SQL Server) with R • Stijn Van Hoey'>
<meta property='og:description' content='Database access using R'>
<meta property='og:url' content='/tutorials/r_database_access/'>
<meta property='og:site_name' content='INBO Tutorials'>
<meta property='og:type' content='article'><meta property='article:section' content='tutorials'><meta property='article:tag' content='database'><meta property='article:tag' content='r'><meta property='article:tag' content='data'><meta property='article:published_time' content='2017-02-03T00:00:00Z'/><meta property='article:modified_time' content='2017-02-03T00:00:00Z'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.88.1" />

  <title>Read data from INBO databases (SQL Server) with R • Stijn Van Hoey</title>
  <link rel='canonical' href='/tutorials/r_database_access/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.ab98e12b.css'><link rel='stylesheet' href='/css/custom.css'><style>
:root{--color-accent:#c04384;}
</style>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        {left: '\\[', right: '\\]', display: true},   
        {left: '$$', right: '$$', display: true},     
        {left: '\\(', right: '\\)', display: false},  
      ],
      throwOnError : false
    });
  });
</script>



</head>
<body class='page type-tutorials has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/'>
        <img src='/images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
      <a href='/'>
       
      </a>
    </h2>
    <div class='desc'>
    
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'> </h4>
  </header>

  <form action='/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='/'>Home</a></li><li class='item'>
  <a href='/articles/'>Articles</a></li><li class='item has-current'>
  <a href='/tutorials/'>Tutorials</a></li><li class='item'>
  <a href='/create_tutorial/'>Create tutorial</a></li><li class='item has-children'>
  <a href='/installation/'>Installation</a><button class='sub-menu-toggler'>
    <span class='screen-reader-text'>expand sub menu</span>
    <span class='sign'></span>
  </button>

  <ul class='sub-menu'><li class='item'>
  <a href='/installation/administrator/'>For admins</a></li><li class='item'>
  <a href='/installation/user/'>For users</a></li></ul></li><li class='item'>
  <a href='/categories/'>Categories</a></li><li class='item'>
  <a href='https://github.com/inbo/tutorials'>Repository</a></li></ul>
    </div>
  </nav>

</section><section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud no-shuffle'><li>
        <a href='/tags/analysis/' style='font-size:1.0632911392405062em'>analysis</a>
      </li><li>
        <a href='/tags/analysis-of-variance/' style='font-size:1em'>analysis of variance</a>
      </li><li>
        <a href='/tags/api/' style='font-size:1.0126582278481013em'>api</a>
      </li><li>
        <a href='/tags/bibliography/' style='font-size:1.0126582278481013em'>bibliography</a>
      </li><li>
        <a href='/tags/binning/' style='font-size:1em'>binning</a>
      </li><li>
        <a href='/tags/biodiversity/' style='font-size:1.0126582278481013em'>biodiversity</a>
      </li><li>
        <a href='/tags/biorad/' style='font-size:1em'>bioRad</a>
      </li><li>
        <a href='/tags/bookdown/' style='font-size:1.0126582278481013em'>bookdown</a>
      </li><li>
        <a href='/tags/brms/' style='font-size:1em'>brms</a>
      </li><li>
        <a href='/tags/checklist/' style='font-size:1.0253164556962024em'>checklist</a>
      </li><li>
        <a href='/tags/ci/' style='font-size:1.0126582278481013em'>ci</a>
      </li><li>
        <a href='/tags/co-variance/' style='font-size:1em'>co-variance</a>
      </li><li>
        <a href='/tags/coding-club/' style='font-size:1em'>coding club</a>
      </li><li>
        <a href='/tags/csl/' style='font-size:1.0126582278481013em'>csl</a>
      </li><li>
        <a href='/tags/data/' style='font-size:1.0253164556962024em'>data</a>
      </li><li>
        <a href='/tags/database/' style='font-size:1.0506329113924051em'>database</a>
      </li><li>
        <a href='/tags/de-trending/' style='font-size:1em'>de-trending</a>
      </li><li>
        <a href='/tags/development/' style='font-size:1.0126582278481013em'>development</a>
      </li><li>
        <a href='/tags/dplyr/' style='font-size:1em'>dplyr</a>
      </li><li>
        <a href='/tags/e-book/' style='font-size:1em'>e-book</a>
      </li><li>
        <a href='/tags/effectclass/' style='font-size:1.0253164556962024em'>effectclass</a>
      </li><li>
        <a href='/tags/endnote/' style='font-size:1em'>endnote</a>
      </li><li>
        <a href='/tags/etn/' style='font-size:1em'>etn</a>
      </li><li>
        <a href='/tags/explorative-data-analysis/' style='font-size:1em'>explorative data analysis</a>
      </li><li>
        <a href='/tags/frictionless/' style='font-size:1em'>frictionless</a>
      </li><li>
        <a href='/tags/gbif/' style='font-size:1.0126582278481013em'>gbif</a>
      </li><li>
        <a href='/tags/generalized-linear-regression/' style='font-size:1.0126582278481013em'>generalized linear regression</a>
      </li><li>
        <a href='/tags/ggplot2/' style='font-size:1.0126582278481013em'>ggplot2</a>
      </li><li>
        <a href='/tags/gis/' style='font-size:1.139240506329114em'>gis</a>
      </li><li>
        <a href='/tags/git/' style='font-size:1.1265822784810127em'>git</a>
      </li><li>
        <a href='/tags/gitbook/' style='font-size:1.0126582278481013em'>gitbook</a>
      </li><li>
        <a href='/tags/github/' style='font-size:1.0379746835443038em'>github</a>
      </li><li>
        <a href='/tags/google/' style='font-size:1.0126582278481013em'>google</a>
      </li><li>
        <a href='/tags/grids/' style='font-size:1em'>grids</a>
      </li><li>
        <a href='/tags/gwlogger/' style='font-size:1.0379746835443038em'>gwloggeR</a>
      </li><li>
        <a href='/tags/inbodb/' style='font-size:1.0253164556962024em'>inbodb</a>
      </li><li>
        <a href='/tags/inbomd/' style='font-size:1.0379746835443038em'>INBOmd</a>
      </li><li>
        <a href='/tags/inborutils/' style='font-size:1.0379746835443038em'>inborutils</a>
      </li><li>
        <a href='/tags/inla/' style='font-size:1.0253164556962024em'>INLA</a>
      </li><li>
        <a href='/tags/inlabru/' style='font-size:1em'>inlabru</a>
      </li><li>
        <a href='/tags/inlatools/' style='font-size:1.0253164556962024em'>inlatools</a>
      </li><li>
        <a href='/tags/installation/' style='font-size:1.1139240506329113em'>installation</a>
      </li><li>
        <a href='/tags/literature/' style='font-size:1.0506329113924051em'>literature</a>
      </li><li>
        <a href='/tags/maps/' style='font-size:1.0759493670886076em'>maps</a>
      </li><li>
        <a href='/tags/markdown/' style='font-size:1.0253164556962024em'>markdown</a>
      </li><li>
        <a href='/tags/mendeley/' style='font-size:1em'>mendeley</a>
      </li><li>
        <a href='/tags/mgrs/' style='font-size:1em'>mgrs</a>
      </li><li>
        <a href='/tags/mixed-model/' style='font-size:1.0632911392405062em'>mixed model</a>
      </li><li>
        <a href='/tags/mixed-models/' style='font-size:1em'>mixed models</a>
      </li><li>
        <a href='/tags/multivariate-statistics/' style='font-size:1em'>multivariate statistics</a>
      </li><li>
        <a href='/tags/n2khab/' style='font-size:1.0506329113924051em'>n2khab</a>
      </li><li>
        <a href='/tags/open-science/' style='font-size:1.0886075949367089em'>open science</a>
      </li><li>
        <a href='/tags/packages/' style='font-size:1.0379746835443038em'>packages</a>
      </li><li>
        <a href='/tags/pandoc/' style='font-size:1.0126582278481013em'>pandoc</a>
      </li><li>
        <a href='/tags/python/' style='font-size:1em'>python</a>
      </li><li>
        <a href='/tags/r/' style='font-size:2em'>r</a>
      </li><li>
        <a href='/tags/regression/' style='font-size:1em'>regression</a>
      </li><li>
        <a href='/tags/renv/' style='font-size:1em'>renv</a>
      </li><li>
        <a href='/tags/reports/' style='font-size:1.0126582278481013em'>reports</a>
      </li><li>
        <a href='/tags/rgbif/' style='font-size:1.0632911392405062em'>rgbif</a>
      </li><li>
        <a href='/tags/rmarkdown/' style='font-size:1.0253164556962024em'>rmarkdown</a>
      </li><li>
        <a href='/tags/rstudio/' style='font-size:1.0506329113924051em'>rstudio</a>
      </li><li>
        <a href='/tags/spatial/' style='font-size:1em'>spatial</a>
      </li><li>
        <a href='/tags/spreadsheet/' style='font-size:1em'>spreadsheet</a>
      </li><li>
        <a href='/tags/sql/' style='font-size:1em'>SQL</a>
      </li><li>
        <a href='/tags/stan/' style='font-size:1em'>stan</a>
      </li><li>
        <a href='/tags/styleguide/' style='font-size:1.0379746835443038em'>styleguide</a>
      </li><li>
        <a href='/tags/tidyverse/' style='font-size:1.0379746835443038em'>tidyverse</a>
      </li><li>
        <a href='/tags/uncertainty/' style='font-size:1.0126582278481013em'>uncertainty</a>
      </li><li>
        <a href='/tags/utm/' style='font-size:1em'>utm</a>
      </li><li>
        <a href='/tags/version-control/' style='font-size:1.1012658227848102em'>version control</a>
      </li><li>
        <a href='/tags/vignette/' style='font-size:1.481012658227848em'>vignette</a>
      </li><li>
        <a href='/tags/visual-markdown-editing/' style='font-size:1em'>visual markdown editing</a>
      </li><li>
        <a href='/tags/vmm/' style='font-size:1em'>vmm</a>
      </li><li>
        <a href='/tags/waterinfo/' style='font-size:1.0253164556962024em'>wateRinfo</a>
      </li><li>
        <a href='/tags/watina/' style='font-size:1.0253164556962024em'>watina</a>
      </li><li>
        <a href='/tags/webservice/' style='font-size:1.0379746835443038em'>webservice</a>
      </li><li>
        <a href='/tags/windows/' style='font-size:1em'>windows</a>
      </li><li>
        <a href='/tags/zenodo/' style='font-size:1em'>zenodo</a>
      </li><li>
        <a href='/tags/zotero/' style='font-size:1.0126582278481013em'>zotero</a>
      </li></ul>
</div>


</section>
<section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/inbo' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://facebook.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Facebook account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section>
<section class='widget widget-build_time sep-after'>
  <p><small>Built on: Mon Mar 31 10:09:05 UTC 2025</small></p>
</section></div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button><div class='header-widgets'>
        <div class='container'>
    
    <style>.widget-breadcrumbs li:after{content:'\2f '}</style>
  <section class='widget widget-breadcrumbs sep-after'>
    <nav id='breadcrumbs'>
      <ol><li><a href='/'>Home</a></li><li><a href='/tutorials/'>Tutorials</a></li><li><span>Read data from INBO databases (SQL Server) with R</span></li></ol>
    </nav>
  </section></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>INBO Tutorials</p><p class='desc site-desc'></p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Read data from INBO databases (SQL Server) with R</h1>
      
<p class='desc'>Database access using R</p>


    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2017-02-03T00:00:00Z'>2017, Feb 03</time>
</span>

  <span class='byline'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
  <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
  
</svg>
<span class='screen-reader-text'> by </span><a href='/authors/stijnvanhoey'>Stijn Van Hoey</a></span>
  <br/>
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
8 mins read
</span>


  <span class="github-link">

    

        

        
            
        

        
            <a href='https://github.com/inbo/tutorials/edit/master/content/tutorials/r_database_access/index.Rmd'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
Improve this page</a>
        

        
    
</span>

</div>


  </div>
</header>

  
  

  <div class='container entry-content'><h2 id="connection-to-inbo-database">Connection to INBO database<a href="#connection-to-inbo-database" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Here we provide the approach using the package DBI, which is also used
by RStudio.[1]. This package enables the link between R and the (remote)
database. After installation of the needed packages
(<code>install.packages(c(&quot;DBI&quot;, &quot;glue&quot;, &quot;tidyverse&quot;))</code>), the packages can be
loaded:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">library</span>(DBI)
<span style="color:#0a0">library</span>(glue)
<span style="color:#0a0">library</span>(tidyverse)
</code></pre></div><p>To create a database connection, different approaches are available as
explained in the next section:</p>
<ol>
<li>Use the dedicated <code>connect_inbo_dbase</code> function in the inbodb
package</li>
<li>Setup the required parameters yourself</li>
<li>Reuse existing registered connections on your computer</li>
</ol>
<h3 id="inbodb-function">Inbodb function<a href="#inbodb-function" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>To support the connection to INBO databases, a dedicated function is
available in the <a href="https://inbo.github.io/inbodb">inbodb package</a>, called
<code>connect_inbo_dbase</code>. The function provides support to connect to INBO
databases and uses the <em>Connections pane</em> in the Rstudio interface:</p>
<p><img src="./database-R/connections_pane.png" alt="odbc-connecties"></p>
<p>To use the <code>connect_inbo_dbase</code> function, make sure to install the
<code>inbodb</code> package, following the <a href="https://inbo.github.io/inbodb/#installation">installation
instructions</a>. After a
successfull installation, load the library and create a database
connection:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">library</span>(inbodb)
my_connection &lt;- <span style="color:#0a0">connect_inbo_dbase</span>(<span style="color:#a50">&#34;D0021_00_userFlora&#34;</span>)
</code></pre></div><p>Once the connection is successfully established, the database can be
queried.</p>
<p><strong>Remark for Linux users</strong>: When working in Linux, this setup (using
<code>Trusted connection</code>) requires an active <em>kerberos</em> session. More
information about the setup and functionality is to be found in the
<a href="https://inbo.github.io/tutorials/installation/user/user_install_kerberos/">tutorial on kerberos
installation</a>.</p>
<h3 id="setting-up-the-connection-yourself">Setting up the connection yourself<a href="#setting-up-the-connection-yourself" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>In case you want to setup the connection yourself (e.g. errors using
inbodb), you can do so by providing the necessary parameters:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">my_connection &lt;- DBI::<span style="color:#0a0">dbConnect</span>(odbc::<span style="color:#0a0">odbc</span>(),
      driver = <span style="color:#a50">&#34;ODBC Driver 17 for SQL Server&#34;</span>,
      server = <span style="color:#a50">&#34;&lt;server hostname or IP&gt;&#34;</span>,
      port = <span style="color:#099">1433</span>,
      database = <span style="color:#a50">&#34;D0021_00_userFlora&#34;</span>, <span style="color:#aaa;font-style:italic"># or your database of interest</span>
      trusted_connection = <span style="color:#a50">&#34;Yes&#34;</span>)
</code></pre></div><p>The most important parameters are <code>server</code> and <code>database</code>, the others should
normally be kept as such (except for maybe <code>driver</code>).
For <code>server</code>, keep in mind that there is more than one server: database names
starting with <code>M</code>, <code>S</code> or <code>W</code> use another server than those starting with <code>D</code>.
The database
name is the name of the database (if you can’t remember the name,
connect with a database you do know, e.g. <em>D0021_00_userFlora</em> and
you’ll see an overview of the existing databases on that server after
connecting.) The driver version depends on your computer and can be
looked up using <code>odbc::odbcListDrivers()</code>.</p>
<h3 id="use-existing-msaccess-connection-name">Use existing MSAccess connection name<a href="#use-existing-msaccess-connection-name" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>When you query data from a SQL database that is already accessible using
MSAccess, such a database is also accessible from R. For Windows users,
the most important element is to know the so-called <code>DSN</code> (i.e. a
registered Data Source Name). Actually, it is just the name of the
database as it is known by your computer (and MS Access). The easiest
way to check the <code>DSN</code> is to check the <a href="http://www.stata.com/support/faqs/data-management/configuring-odbc-win/"><em>registered ODBC
connections</em></a>
in the administrator tools menu.</p>
<p>For Dutch-speaking Windows 7 users:</p>
<pre><code>&gt; Kies in het Configuratiescherm van Windows de optie Systeembeheer &gt; Gegevensbronnen (ODBC). De optie Systeembeheer verschijnt in de categorie Systeem en onderhoud.
</code></pre>
<p>You should see a list similar to the list underneath, with the names of
the available DSN names enlisted:</p>
<p><img src="./database-R/odbc_gegevensbron.png" alt="odbc-connecties"></p>
<p>An alternative way to check the DSN name of a database already working
on with Access, is to check the DSN inside MS Access (in dutch, check
menu item <em>Koppelingsbeheer</em>):</p>
<p><img src="./database-R/access_dsn.png" alt="access-dsn"></p>
<p>For example, the DSN name <code>UserFlora</code> or <code>Cydonia-prd</code> can be used to
query these databases and extract data from it with similar queries to
the one used in MSAccess. First of all, the connection with the database
need to be established, by using the <code>odbcConnect</code> function, providing
the DSN name as argument:</p>
<p>For Windows users:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">my_connection &lt;- <span style="color:#0a0">odbcConnect</span>(<span style="color:#a50">&#34;UserFlora&#34;</span>)
</code></pre></div><p>Once the connection is successfully established, the database can be
queried.</p>
<h2 id="get-a-complete-table-from-the-database">Get a complete table from the database<a href="#get-a-complete-table-from-the-database" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The function <code>dbReadTable</code> can be used to load an entire table from a
database. For example, to extract the <code>tblTaxon</code> table from the flora
database:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">rel_taxa &lt;- <span style="color:#0a0">dbReadTable</span>(my_connection, <span style="color:#a50">&#34;relTaxonTaxonGroep&#34;</span>)
<span style="color:#0a0">head</span>(rel_taxa) %&gt;% knitr::<span style="color:#0a0">kable</span>()
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right">ID</th>
<th style="text-align:right">TaxonGroepID</th>
<th style="text-align:right">TaxonID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">4</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">4</td>
<td style="text-align:right">6</td>
</tr>
</tbody>
</table>
<p>The connection <code>my_connection</code>, made earlier, is used as the first
argument. The table name is the second argument.</p>
<p><strong>Remark:</strong> If you have no idea about the size of the table you’re
trying to load from the database, this could be rather tricky and
cumbersome. Hence, it is probably better to only extract a portion of
the table using a query.</p>
<h2 id="execute-a-query-to-the-database">Execute a query to the database<a href="#execute-a-query-to-the-database" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The function <code>dbGetQuery</code> provides more flexibilty as it can be used to
try any SQL-query on the database. A complete introduction to the SQL
language is out of scope here. We will focus on the application and the
reusage of a query.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">meting &lt;- <span style="color:#0a0">dbGetQuery</span>(my_connection, <span style="color:#0a0">paste</span>(<span style="color:#a50">&#34;SELECT TOP 10 * FROM dbo.tblMeting&#34;</span>, 
                                          <span style="color:#a50">&#34;WHERE COR_X IS NOT NULL&#34;</span>))
<span style="color:#0a0">head</span>(meting) %&gt;% knitr::<span style="color:#0a0">kable</span>()
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right">ID</th>
<th style="text-align:right">WaarnemingID</th>
<th style="text-align:right">TaxonID</th>
<th style="text-align:left">MetingStatusCode</th>
<th style="text-align:right">Cor_X</th>
<th style="text-align:right">Cor_Y</th>
<th style="text-align:left">CommentaarTaxon</th>
<th style="text-align:left">CommentaarHabitat</th>
<th style="text-align:left">CREATION_DATE</th>
<th style="text-align:left">CREATION_USER</th>
<th style="text-align:left">UPDATE_DATE</th>
<th style="text-align:left">UPDATE_USER</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">21748</td>
<td style="text-align:right">3909</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:right">109948</td>
<td style="text-align:right">185379</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
</tr>
<tr>
<td style="text-align:right">14</td>
<td style="text-align:right">45523</td>
<td style="text-align:right">3909</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:right">127708</td>
<td style="text-align:right">179454</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
</tr>
<tr>
<td style="text-align:right">15</td>
<td style="text-align:right">124394</td>
<td style="text-align:right">3909</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:right">109424</td>
<td style="text-align:right">192152</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
</tr>
<tr>
<td style="text-align:right">23</td>
<td style="text-align:right">38561</td>
<td style="text-align:right">3909</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:right">128290</td>
<td style="text-align:right">179297</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
</tr>
<tr>
<td style="text-align:right">24</td>
<td style="text-align:right">126500</td>
<td style="text-align:right">3909</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:right">98714</td>
<td style="text-align:right">178373</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
</tr>
<tr>
<td style="text-align:right">173</td>
<td style="text-align:right">73725</td>
<td style="text-align:right">3909</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:right">102612</td>
<td style="text-align:right">189891</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
<td style="text-align:left">NA</td>
</tr>
</tbody>
</table>
<h2 id="create-and-use-query-templates">Create and use query templates<a href="#create-and-use-query-templates" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>When you regularly use similar queries, with some minimal alterations,
you do not want to copy/paste each time the entire query. It is prone to
errors and you’re script will become verbose. It is advisable to create
query <em>templates</em>, that can be used within the <code>dbGetQuery</code> function.</p>
<p>Consider the execution of the following query. We are interested in
those records with valid X and Y coordinates for the measurement, based
on a given dutch name:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">subset_meting &lt;- <span style="color:#0a0">dbGetQuery</span>(my_connection, 
    <span style="color:#a50">&#34;SELECT meet.COR_X
</span><span style="color:#a50">         , meet.Cor_Y
</span><span style="color:#a50">         , meet.MetingStatusCode
</span><span style="color:#a50">         , tax.NaamNederlands
</span><span style="color:#a50">         , tax.NaamWetenschappelijk
</span><span style="color:#a50">         , waar.IFBLHokID
</span><span style="color:#a50">    FROM  tblMeting AS meet
</span><span style="color:#a50">        LEFT JOIN tblTaxon AS tax ON tax.ID = meet.TaxonID
</span><span style="color:#a50">        LEFT JOIN tblWaarneming AS waar ON waar.ID = meet.WaarnemingID
</span><span style="color:#a50">    WHERE meet.Cor_X IS NOT NULL
</span><span style="color:#a50">        AND meet.Cor_X != 0
</span><span style="color:#a50">        AND tax.NaamNederlands LIKE &#39;Wilde hyacint&#39;&#34;</span>)
<span style="color:#0a0">head</span>(subset_meting) %&gt;% knitr::<span style="color:#0a0">kable</span>()
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right">COR_X</th>
<th style="text-align:right">Cor_Y</th>
<th style="text-align:left">MetingStatusCode</th>
<th style="text-align:left">NaamNederlands</th>
<th style="text-align:left">NaamWetenschappelijk</th>
<th style="text-align:right">IFBLHokID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">88720</td>
<td style="text-align:right">208327</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">11195</td>
</tr>
<tr>
<td style="text-align:right">24106</td>
<td style="text-align:right">199925</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">9601</td>
</tr>
<tr>
<td style="text-align:right">103111</td>
<td style="text-align:right">190915</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">6990</td>
</tr>
<tr>
<td style="text-align:right">118123</td>
<td style="text-align:right">183942</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">5672</td>
</tr>
<tr>
<td style="text-align:right">106107</td>
<td style="text-align:right">182343</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">5217</td>
</tr>
<tr>
<td style="text-align:right">105765</td>
<td style="text-align:right">180785</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">4830</td>
</tr>
</tbody>
</table>
<p>If we need this query regularly, but each time using a different
<code>tax.NaamNederlands</code> (only the name changes), it is worthwhile to invest
some time in the creation of a small custom function that uses this
query as a template. Let’s create a function
<code>flora_records_on_dutch_name</code> that takes a valid database connection and
a given Dutch name and returns the relevant subset of the data for this
query:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">flora_records_on_dutch_name &lt;- <span style="color:#0a0">function</span>(dbase_connection, dutch_name) {
     <span style="color:#0a0">dbGetQuery</span>(dbase_connection, <span style="color:#0a0">glue_sql</span>(
            <span style="color:#a50">&#34;SELECT meet.Cor_X
</span><span style="color:#a50">                 , meet.COr_Y
</span><span style="color:#a50">                 , meet.MetingStatusCode
</span><span style="color:#a50">                 , tax.NaamNederlands
</span><span style="color:#a50">                 , tax.NaamWetenschappelijk
</span><span style="color:#a50">                 , waar.IFBLHokID
</span><span style="color:#a50">            FROM  dbo.tblMeting meet
</span><span style="color:#a50">                LEFT JOIN dbo.tblTaxon AS tax ON tax.ID = meet.TaxonID
</span><span style="color:#a50">                LEFT JOIN dbo.tblWaarneming AS waar ON waar.ID = meet.WaarnemingID
</span><span style="color:#a50">            WHERE meet.Cor_X IS NOT NULL
</span><span style="color:#a50">                AND meet.Cor_X != 0
</span><span style="color:#a50">                AND tax.NaamNederlands LIKE {dutch_name}&#34;</span>,
            dutch_name = dutch_name,
            .con = dbase_connection))
}
</code></pre></div><p>Hence, instead of copy-pasting the whole query each time (which could be
error-prone), we can reuse the function for different names:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">hyacint &lt;- <span style="color:#0a0">flora_records_on_dutch_name</span>(my_connection, <span style="color:#a50">&#34;Wilde hyacint&#34;</span>)
<span style="color:#0a0">head</span>(hyacint) %&gt;% knitr::<span style="color:#0a0">kable</span>()
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right">Cor_X</th>
<th style="text-align:right">COr_Y</th>
<th style="text-align:left">MetingStatusCode</th>
<th style="text-align:left">NaamNederlands</th>
<th style="text-align:left">NaamWetenschappelijk</th>
<th style="text-align:right">IFBLHokID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">88720</td>
<td style="text-align:right">208327</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">11195</td>
</tr>
<tr>
<td style="text-align:right">24106</td>
<td style="text-align:right">199925</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">9601</td>
</tr>
<tr>
<td style="text-align:right">103111</td>
<td style="text-align:right">190915</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">6990</td>
</tr>
<tr>
<td style="text-align:right">118123</td>
<td style="text-align:right">183942</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">5672</td>
</tr>
<tr>
<td style="text-align:right">106107</td>
<td style="text-align:right">182343</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">5217</td>
</tr>
<tr>
<td style="text-align:right">105765</td>
<td style="text-align:right">180785</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Wilde hyacint</td>
<td style="text-align:left">Hyacinthoides non-scripta (L.) Chouard ex Rothm.</td>
<td style="text-align:right">4830</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">bosanemoon &lt;- <span style="color:#0a0">flora_records_on_dutch_name</span>(my_connection, <span style="color:#a50">&#34;Bosanemoon&#34;</span>)
<span style="color:#0a0">head</span>(bosanemoon) %&gt;% knitr::<span style="color:#0a0">kable</span>()
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right">Cor_X</th>
<th style="text-align:right">COr_Y</th>
<th style="text-align:left">MetingStatusCode</th>
<th style="text-align:left">NaamNederlands</th>
<th style="text-align:left">NaamWetenschappelijk</th>
<th style="text-align:right">IFBLHokID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">119247</td>
<td style="text-align:right">204936</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Bosanemoon</td>
<td style="text-align:left">Anemone nemorosa L.</td>
<td style="text-align:right">10234</td>
</tr>
<tr>
<td style="text-align:right">73658</td>
<td style="text-align:right">199081</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Bosanemoon</td>
<td style="text-align:left">Anemone nemorosa L.</td>
<td style="text-align:right">8823</td>
</tr>
<tr>
<td style="text-align:right">72752</td>
<td style="text-align:right">199010</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Bosanemoon</td>
<td style="text-align:left">Anemone nemorosa L.</td>
<td style="text-align:right">8824</td>
</tr>
<tr>
<td style="text-align:right">72921</td>
<td style="text-align:right">198828</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Bosanemoon</td>
<td style="text-align:left">Anemone nemorosa L.</td>
<td style="text-align:right">8824</td>
</tr>
<tr>
<td style="text-align:right">72874</td>
<td style="text-align:right">198735</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Bosanemoon</td>
<td style="text-align:left">Anemone nemorosa L.</td>
<td style="text-align:right">8824</td>
</tr>
<tr>
<td style="text-align:right">72887</td>
<td style="text-align:right">198660</td>
<td style="text-align:left">GDGA</td>
<td style="text-align:left">Bosanemoon</td>
<td style="text-align:left">Anemone nemorosa L.</td>
<td style="text-align:right">8824</td>
</tr>
</tbody>
</table>
<p><strong>Remark:</strong> Do not forget to close your connection when finished.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">dbDisconnect</span>(my_connection)
</code></pre></div><h2 id="the-glue_sql-function">The <code>glue_sql</code> function<a href="#the-glue_sql-function" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>In order to accomplish the re-usage of a query for different input names
(<code>dutch_name</code>), the <code>glue_sql</code> function is used from the <a href="https://glue.tidyverse.org/reference/glue_sql.html">glue
package</a>. The
<code>glue_sql</code> function (and the more general <code>glue</code> function) provides the
ability to combine text and variable values in a single charactor string
(i.e. the query to execute). For each variable name required in the
query (any part of your query you want to have interchangeable), a
representation in the query is given by the variable name you use in R,
put in between curly brackets. For example, if you have the <code>dutch_name</code>
variable in R, you can use it inside the query as <code>{dutch_name}</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">dutch_name &lt;- <span style="color:#a50">&#39;Jan&#39;</span>
an_integer &lt;- <span style="color:#099">3</span>
a_float &lt;- <span style="color:#099">2.8</span>
<span style="color:#0a0">glue</span>(<span style="color:#a50">&#39;This prints a combination of a name: {dutch_name}, an integer: {an_integer} and a float value: {a_float}&#39;</span>)
</code></pre></div><pre><code>## This prints a combination of a name: Jan, an integer: 3 and a float value: 2.8
</code></pre>
<p>Whereas the <code>glue</code> function is a general function for strings, the
<code>glue_sql</code> function is specifically created to setup queries to
databases. More information is provided
<a href="https://db.rstudio.com/best-practices/run-queries-safely/#using-glue_sql">here</a>
and <a href="https://glue.tidyverse.org/reference/glue_sql.html">here</a>.</p>
<p>[1] Formerly, connections were made using the package
<a href="https://cran.r-project.org/web/packages/RODBC/index.html">RODBC</a></p>
</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
<span class='screen-reader-text'>Categories: </span><a class='category' href='/categories/r/'>r</a></div>
<div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/database/'>database</a>, <a class='tag' href='/tags/r/'>r</a>, <a class='tag' href='/tags/data/'>data</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='next-entry sep-before'>
      <a href='/tutorials/r_large_data_files_handling/'>
        <span class='screen-reader-text'>Next post: </span>Reading large data files in R<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p><a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://inbo.github.io/tutorials/images/cc-by.svg" alt="CC BY 4.0"></a> &copy; 2018-2025 Research Institute for Nature and Forest (INBO) </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.c3bcf2df.js'></script><script src='/js/custom.js'></script>

</body>

</html>

