<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Current good practice in specifying a CRS in R'>
<meta name='theme-color' content='#c04384'>

<meta property='og:title' content='Goodbye PROJ.4 strings! How to specify a coordinate reference system in R? • Floris Vanderhaeghe'>
<meta property='og:description' content='Current good practice in specifying a CRS in R'>
<meta property='og:url' content='https://inbo.github.io/tutorials/tutorials/spatial_crs_coding/'>
<meta property='og:site_name' content='INBO Tutorials'>
<meta property='og:type' content='article'><meta property='article:section' content='tutorials'><meta property='article:tag' content='gis'><meta property='article:tag' content='r'><meta property='article:tag' content='maps'><meta property='article:published_time' content='2020-09-18T00:00:00Z'/><meta property='article:modified_time' content='2020-09-18T00:00:00Z'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.62.2" />

  <title>Goodbye PROJ.4 strings! How to specify a coordinate reference system in R? • Floris Vanderhaeghe</title>
  <link rel='canonical' href='https://inbo.github.io/tutorials/tutorials/spatial_crs_coding/'>
  
  
  <link rel='icon' href='/tutorials/favicon.ico'>
<link rel='stylesheet' href='/tutorials/assets/css/main.dd2efce5.css'><link rel='stylesheet' href='/tutorials/css/custom.css'><style>
:root{--color-accent:#c04384;}
</style>

  

</head>
<body class='page type-tutorials has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/tutorials/'>
        <img src='/tutorials/images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
     
    </h2>
    <div class='desc'>
    
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'> </h4>
  </header>

  <form action='/tutorials/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='/tutorials/'>Home</a></li><li class='item'>
  <a href='/tutorials/articles/'>Articles</a></li><li class='item'>
  <a href='/tutorials/tutorials/'>Tutorials</a></li><li class='item'>
  <a href='/tutorials/create_tutorial/'>Create tutorial</a></li><li class='item has-children'>
  <a href='/tutorials/installation/'>Installation</a><button class='sub-menu-toggler'>
    <span class='screen-reader-text'>expand sub menu</span>
    <span class='sign'></span>
  </button>

  <ul class='sub-menu'><li class='item'>
  <a href='/tutorials/installation/administrator/'>For admins</a></li><li class='item'>
  <a href='/tutorials/installation/user/'>For users</a></li></ul></li><li class='item'>
  <a href='/tutorials/categories/'>Categories</a></li><li class='item'>
  <a href='https://github.com/inbo/tutorials'>Repository</a></li></ul>
    </div>
  </nav>

</section><section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud no-shuffle'><li>
        <a href='/tutorials/tags/analysis/' style='font-size:1.1142857142857143em'>analysis</a>
      </li><li>
        <a href='/tutorials/tags/analysis-of-variance/' style='font-size:1em'>analysis of variance</a>
      </li><li>
        <a href='/tutorials/tags/api/' style='font-size:1em'>api</a>
      </li><li>
        <a href='/tutorials/tags/bibliography/' style='font-size:1em'>bibliography</a>
      </li><li>
        <a href='/tutorials/tags/biodiversity/' style='font-size:1em'>biodiversity</a>
      </li><li>
        <a href='/tutorials/tags/bookdown/' style='font-size:1em'>bookdown</a>
      </li><li>
        <a href='/tutorials/tags/ci/' style='font-size:1.0285714285714285em'>ci</a>
      </li><li>
        <a href='/tutorials/tags/coding-club/' style='font-size:1em'>coding club</a>
      </li><li>
        <a href='/tutorials/tags/csl/' style='font-size:1em'>csl</a>
      </li><li>
        <a href='/tutorials/tags/data/' style='font-size:1.0571428571428572em'>data</a>
      </li><li>
        <a href='/tutorials/tags/database/' style='font-size:1.1142857142857143em'>database</a>
      </li><li>
        <a href='/tutorials/tags/development/' style='font-size:1.0285714285714285em'>development</a>
      </li><li>
        <a href='/tutorials/tags/dplyr/' style='font-size:1em'>dplyr</a>
      </li><li>
        <a href='/tutorials/tags/e-book/' style='font-size:1em'>e-book</a>
      </li><li>
        <a href='/tutorials/tags/effectclass/' style='font-size:1em'>effectclass</a>
      </li><li>
        <a href='/tutorials/tags/endnote/' style='font-size:1em'>endnote</a>
      </li><li>
        <a href='/tutorials/tags/explorative-data-analysis/' style='font-size:1em'>explorative data analysis</a>
      </li><li>
        <a href='/tutorials/tags/gbif/' style='font-size:1em'>gbif</a>
      </li><li>
        <a href='/tutorials/tags/generalized-linear-regression/' style='font-size:1em'>generalized linear regression</a>
      </li><li>
        <a href='/tutorials/tags/ggplot2/' style='font-size:1.0285714285714285em'>ggplot2</a>
      </li><li>
        <a href='/tutorials/tags/gis/' style='font-size:1.2285714285714286em'>gis</a>
      </li><li>
        <a href='/tutorials/tags/git/' style='font-size:1.2em'>git</a>
      </li><li>
        <a href='/tutorials/tags/gitbook/' style='font-size:1em'>gitbook</a>
      </li><li>
        <a href='/tutorials/tags/github/' style='font-size:1.0285714285714285em'>github</a>
      </li><li>
        <a href='/tutorials/tags/google/' style='font-size:1.0285714285714285em'>google</a>
      </li><li>
        <a href='/tutorials/tags/inbomd/' style='font-size:1.0285714285714285em'>INBOmd</a>
      </li><li>
        <a href='/tutorials/tags/inborutils/' style='font-size:1em'>inborutils</a>
      </li><li>
        <a href='/tutorials/tags/inla/' style='font-size:1.0571428571428572em'>INLA</a>
      </li><li>
        <a href='/tutorials/tags/inlabru/' style='font-size:1em'>inlabru</a>
      </li><li>
        <a href='/tutorials/tags/installation/' style='font-size:1.2571428571428571em'>installation</a>
      </li><li>
        <a href='/tutorials/tags/literature/' style='font-size:1.1142857142857143em'>literature</a>
      </li><li>
        <a href='/tutorials/tags/maps/' style='font-size:1.1428571428571428em'>maps</a>
      </li><li>
        <a href='/tutorials/tags/markdown/' style='font-size:1.0285714285714285em'>markdown</a>
      </li><li>
        <a href='/tutorials/tags/mendeley/' style='font-size:1em'>mendeley</a>
      </li><li>
        <a href='/tutorials/tags/mixed-model/' style='font-size:1.1428571428571428em'>mixed model</a>
      </li><li>
        <a href='/tutorials/tags/multivariate-statistics/' style='font-size:1em'>multivariate statistics</a>
      </li><li>
        <a href='/tutorials/tags/open-science/' style='font-size:1.2em'>open science</a>
      </li><li>
        <a href='/tutorials/tags/packages/' style='font-size:1.0571428571428572em'>packages</a>
      </li><li>
        <a href='/tutorials/tags/pandoc/' style='font-size:1em'>pandoc</a>
      </li><li>
        <a href='/tutorials/tags/python/' style='font-size:1em'>python</a>
      </li><li>
        <a href='/tutorials/tags/queries/' style='font-size:1em'>queries</a>
      </li><li>
        <a href='/tutorials/tags/r/' style='font-size:2em'>r</a>
      </li><li>
        <a href='/tutorials/tags/reports/' style='font-size:1em'>reports</a>
      </li><li>
        <a href='/tutorials/tags/rmarkdown/' style='font-size:1.0285714285714285em'>rmarkdown</a>
      </li><li>
        <a href='/tutorials/tags/rstudio/' style='font-size:1.0571428571428572em'>rstudio</a>
      </li><li>
        <a href='/tutorials/tags/spreadsheet/' style='font-size:1em'>spreadsheet</a>
      </li><li>
        <a href='/tutorials/tags/sql/' style='font-size:1em'>SQL</a>
      </li><li>
        <a href='/tutorials/tags/styleguide/' style='font-size:1.0571428571428572em'>styleguide</a>
      </li><li>
        <a href='/tutorials/tags/tidyverse/' style='font-size:1.0857142857142856em'>tidyverse</a>
      </li><li>
        <a href='/tutorials/tags/uncertainty/' style='font-size:1.0285714285714285em'>uncertainty</a>
      </li><li>
        <a href='/tutorials/tags/version-control/' style='font-size:1.1714285714285715em'>version control</a>
      </li><li>
        <a href='/tutorials/tags/vmm/' style='font-size:1em'>vmm</a>
      </li><li>
        <a href='/tutorials/tags/webservice/' style='font-size:1.0571428571428572em'>webservice</a>
      </li><li>
        <a href='/tutorials/tags/windows/' style='font-size:1em'>windows</a>
      </li><li>
        <a href='/tutorials/tags/zotero/' style='font-size:1em'>zotero</a>
      </li></ul>
</div>


</section>
<section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/inbo' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://facebook.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Facebook account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section>
<section class='widget widget-build_time sep-after'>
  <p><small>Built on: Wed Jun 2 07:43:56 UTC 2021</small></p>
</section></div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button><div class='header-widgets'>
        <div class='container'>
    
    <style>.widget-breadcrumbs li:after{content:'\2f '}</style>
  <section class='widget widget-breadcrumbs sep-after'>
    <nav id='breadcrumbs'>
      <ol><li><a href='/tutorials/'>Home</a></li><li><a href='/tutorials/tutorials/'>Tutorials</a></li><li><span>Goodbye PROJ.4 strings! How to specify a coordinate reference system in R?</span></li></ol>
    </nav>
  </section></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>INBO Tutorials</p><p class='desc site-desc'></p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Goodbye PROJ.4 strings! How to specify a coordinate reference system in R?</h1>
      
<p class='desc'>Current good practice in specifying a CRS in R</p>


    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2020-09-18T00:00:00Z'>2020, Sep 18</time>
</span>

  <span class='byline'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
  <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
  
</svg>
<span class='screen-reader-text'> by </span><a href='/tutorials/authors/florisvdh'>Floris Vanderhaeghe</a></span>
  <br/>
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
13 mins read
</span>


  <span class="github-link">

    

        

        
            
        

        
            <a href='https://github.com/inbo/tutorials/blob/master/content/tutorials/spatial_crs_coding/index.Rmd'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
Improve this page</a>
        

        
    
</span>

</div>


  </div>
</header>

  
  

  <div class='container entry-content'><h2 id="coordinate-reference-systems-minimal-background">Coordinate reference systems: minimal background<a href="#coordinate-reference-systems-minimal-background" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<h3 id="what">What?<a href="#what" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>A coordinate reference system (<strong>CRS</strong>) – also called spatial reference
system (SRS) – is what you need if you want to interpret numeric
coordinates as actual point locations with reference to the Earth. Two
types of coordinate reference system exist: <em>geodetic</em> and <em>projected</em>
CRSes. The former serve only to locate coordinates relative to a 3D
model of the Earth surface, while the latter add a projection to
generate coordinates on a 2D map. Coordinate operations convert or
transform coordinates from one CRS to another, and you often need them
because the CRS may differ between dataset 1, dataset 2 or a certain
mapping technology.</p>
<p>As you can expect, a CRS is defined by several elements. Essentially, a
CRS exists of:</p>
<ul>
<li>a coordinate system,</li>
<li>a ‘datum’ (s.l.): it localizes the geodetic coordinate system
relative to the Earth and needs a geometric definition of the
ellipsoid,</li>
<li><em>only for projected CRSes:</em> coordinate conversion parameters that
determine the conversion from the geodetic to the projected
coordinates.</li>
</ul>
<p>We will not go deeper into these components, because we want to focus on
implementation. However it is highly recommended to read further about
this, in order to better understand what a CRS means. A good
contemporary resource in an R context is the section ‘<em>Coordinate
reference systems: background</em>’ in Bivand
(<a href="#ref-bivand_ecs530_2019">2019</a>) (there is also an accompanying
<a href="https://www.youtube.com/watch?v=Rgn4Ns2UgAg&amp;list=PLXUoTpMa_9s10NVk4dBQljNOaOXAOhcE0&amp;index=4&amp;t=0s">video</a>
of that lesson).</p>
<p>There are a few coordinated lists of CRSes around the globe, the most
famous one being the <a href="https://www.epsg.org">EPSG dataset</a>, where each
CRS has a unique <em>EPSG code</em>. You can consult these CRSes interactively
at <a href="http://www.epsg-registry.org">http://www.epsg-registry.org</a> (official source) and through
third-party websites such as <a href="http://epsg.io">http://epsg.io</a>. For example, the ‘World
Geodetic System 1984’ (WGS84) is a geodetic CRS with EPSG code <code>4326</code>,
and ‘Belge 1972 / Belgian Lambert 72’ is a projected CRS with EPSG code
<code>31370</code>.</p>
<h3 id="how-was-a-crs-represented-in-r-evolutions-in-proj-and-gdal">How <em>was</em> a CRS represented in R? Evolutions in PROJ and GDAL.<a href="#how-was-a-crs-represented-in-r-evolutions-in-proj-and-gdal" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>It is good to know this, but you <em>can</em> skip this section if you like.</p>
<p>The reason for writing this tutorial are the recent (and ongoing)
changes in several important geospatial libraries, especially <strong>GDAL</strong>
and <strong>PROJ</strong>. They are used by most geospatial tools, including the key
geospatial R packages <code>rgdal</code>, <code>sp</code>, <code>sf</code> and <code>raster</code>.</p>
<p>Since long, coordinate reference systems in R (and many other tools)
have been represented by so called ‘PROJ.4 strings’ (or ‘proj4strings’),
referring to the long-standing version 4 of the PROJ library. But, we
will not use them here - it is counteradvised to use them any longer!</p>
<p>Let’s just have <strong>one last nostalgic peek</strong> (and then, no more!!): the
proj4string for the Belgian Lambert 72 CRS (EPSG:31370) “<em>was</em>”:</p>
<pre><code>+proj=lcc +lat_1=51.16666723333333 +lat_2=49.8333339 +lat_0=90 +lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +towgs84=-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747 +units=m +no_defs
</code></pre>
<p>Several reasons, such as WGS84 getting outdated, higher accuracy
requirements in transformations and the availability of better standards
than proj4strings, have led to recent changes in PROJ and GDAL. This
also implied reduced compatibility with proj4strings.</p>
<p><strong>GDAL 3</strong> and <strong>PROJ ≥ 6</strong>, which many R packages now support and
promote, will just ignore and drop some parts of the proj4strings (such
as <code>+datum</code> and <code>+towgs84</code> keys) if an R package would still provide it
to them. In R, the older GDAL 2.x and PROJ 4 (and hence, proj4strings)
will still be supported for some time,[1] for their continued use in
older environments.</p>
<p>If you want to read more about the changes, here are some recommended
resources:</p>
<ul>
<li><a href="https://www.r-spatial.org">https://www.r-spatial.org</a> (at the time of writing, especially
Pebesma &amp; Bivand (<a href="#ref-pebesma_r_2020">2020</a>))</li>
<li>Bivand
(<a href="#ref-bivand_migration_2020">2020</a><a href="#ref-bivand_migration_2020">a</a>)
(<code>rgdal</code> vignette)</li>
<li>Bivand
(<a href="#ref-bivand_upstream_2020">2020</a><a href="#ref-bivand_upstream_2020">b</a>)
(video recording; see slides 45-66 in Bivand
(<a href="#ref-bivand_how_2020_1">2020</a><a href="#ref-bivand_how_2020_1">c</a>))</li>
<li><a href="https://gdalbarn.com">https://gdalbarn.com</a></li>
<li>Nowosad &amp; Lovelace (<a href="#ref-nowosad_recent_2020">2020</a>) (webinar and
slides, also including other developments in spatial R)</li>
</ul>
<h3 id="how-is-a-crs-represented-in-r">How <em>is</em> a CRS represented in R?<a href="#how-is-a-crs-represented-in-r" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p><strong>Answer</strong>: It is done by using the
<strong><a href="http://docs.opengeospatial.org/is/18-010r7/18-010r7.html">WKT2</a>
string</strong>, a recent and much better standard, maintained by the Open
Geospatial Consortium. WKT stands for ‘Well-known text’. ‘WKT2’ is
simply the recent version of WKT, approved in 2019, so you can also
refer to it as WKT.[2]</p>
<p>For example, this is the WKT2 string for WGS84:</p>
<pre><code>GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]],
        ID[&quot;EPSG&quot;,6326]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
        ID[&quot;EPSG&quot;,8901]],
    CS[ellipsoidal,2],
        AXIS[&quot;longitude&quot;,east,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                ID[&quot;EPSG&quot;,9122]]],
        AXIS[&quot;latitude&quot;,north,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                ID[&quot;EPSG&quot;,9122]]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;World&quot;],
        BBOX[-90,-180,90,180]]]
</code></pre>
<h2 id="how-to-specify-a-crs-in-r">How to specify a CRS in R?<a href="#how-to-specify-a-crs-in-r" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">library</span>(sp)
<span style="color:#0a0">library</span>(raster)
<span style="color:#0a0">library</span>(sf)
</code></pre></div><p>Great news!<br>
The R packages further down, and many that depend on them, now provide a
means of CRS specification <em>irrespective</em> of the GDAL/PROJ version,
hence compliant with newer GDAL/PROJ.</p>
<ul>
<li>
<p><strong>DO:</strong></p>
<p><strong>The <em>general principle</em> that we recommend is: specify the CRS by
using the <em>EPSG code</em>, but do so <em>without</em> using a proj4string.</strong></p>
</li>
<li>
<p><strong>DON’T:</strong></p>
<p><strong>Don’t use proj4strings, such as <code>+init=epsg:????</code>,
<code>+proj=longlat</code>, … (even though that <em>might</em> still work, continued
support for it is not to be expected).</strong></p>
</li>
</ul>
<p>In the below code chunks, this is demonstrated for several important
geospatial R packages: <strong><code>sf</code></strong>, <strong><code>sp</code></strong> and <strong><code>raster</code></strong>. Other
geospatial R packages should normally inherit their approach.</p>
<p>First, some practical notes:</p>
<ul>
<li>In order to remain compatible with GDAL 2 and PROJ 4, some packages
will still internally derive a proj4string as well (notably by
calling the core package <code>rgdal</code>). This happens even while you did
not enter a proj4string. Note that the derived proj4string will not
be used further if you’re on GDAL 3 / PROJ ≥ 6, and a WKT2 string
will be generated as well for actual use. In the presence of GDAL 3
/ PROJ ≥ 6, you will (at the time of writing) get a <strong>warning</strong>
about dropped keys in the generated proj4strings,[3] but in the
meantime, for most geospatial R packages you can safely ignore this
warning.</li>
<li><strong>Windows</strong> users: to make sure that the <code>rgdal</code> and <code>sf</code> packages
use GDAL 3 / PROJ ≥ 6 – which is now highly advised: please
<strong>update</strong> all your packages in a pure R console (not RStudio) that
uses your latest installed R version, by running
<code>update.packages(ask = FALSE, checkBuilt = TRUE)</code>.</li>
</ul>
<p>As a demo data set for vector data, we use a dataset of city centers
(points) included in the <code>rgdal</code> package.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">cities &lt;- 
  <span style="color:#0a0">st_read</span>(<span style="color:#0a0">system.file</span>(<span style="color:#a50">&#34;</span><span style="color:#a50">vectors/cities.shp&#34;</span>, package = <span style="color:#a50">&#34;</span><span style="color:#a50">rgdal&#34;</span>))
</code></pre></div><p>This is how it looks like:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">cities
</code></pre></div><pre><code>Simple feature collection with 606 features and 4 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: -165.27 ymin: -53.15 xmax: 177.1302 ymax: 78.2
geographic CRS: WGS 84
First 10 features:
               NAME COUNTRY POPULATION CAPITAL                   geometry
1          Murmansk  Russia     468000       N  POINT (33.08604 68.96355)
2       Arkhangelsk  Russia     416000       N  POINT (40.64616 64.52067)
3  Saint Petersburg  Russia    5825000       N  POINT (30.45333 59.95189)
4           Magadan  Russia     152000       N      POINT (150.78 59.571)
5             Perm'  Russia    1160000       N  POINT (56.23246 58.00024)
6     Yekaterinburg  Russia    1620000       N  POINT (60.61013 56.84654)
7  Nizhniy Novgorod  Russia    2025000       N  POINT (43.94067 56.28968)
8           Glasgow      UK    1800000       N POINT (-4.269948 55.86281)
9            Kazan'  Russia    1140000       N  POINT (49.14547 55.73301)
10      Chelyabinsk  Russia    1325000       N    POINT (61.39261 55.145)
</code></pre>
<p>We now convert it to a plain dataframe (non-spatial) with the XY
coordinates as columns, for the sake of the exercise. We want to add the
CRS ourselves!</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">cities &lt;- 
  <span style="color:#0a0">cbind</span>(<span style="color:#0a0">st_drop_geometry</span>(cities), 
        <span style="color:#0a0">st_coordinates</span>(cities))
<span style="color:#0a0">head</span>(cities, <span style="color:#099">10</span>) <span style="color:#aaa;font-style:italic"># top 10 rows</span>
</code></pre></div><pre><code>               NAME COUNTRY POPULATION CAPITAL          X        Y
1          Murmansk  Russia     468000       N  33.086040 68.96355
2       Arkhangelsk  Russia     416000       N  40.646160 64.52067
3  Saint Petersburg  Russia    5825000       N  30.453327 59.95189
4           Magadan  Russia     152000       N 150.780014 59.57100
5             Perm'  Russia    1160000       N  56.232464 58.00024
6     Yekaterinburg  Russia    1620000       N  60.610130 56.84654
7  Nizhniy Novgorod  Russia    2025000       N  43.940670 56.28968
8           Glasgow      UK    1800000       N  -4.269948 55.86281
9            Kazan'  Russia    1140000       N  49.145466 55.73301
10      Chelyabinsk  Russia    1325000       N  61.392612 55.14500
</code></pre><h3 id="sf-package"><code>sf</code> package<a href="#sf-package" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>Note that also the <a href="https://r-spatial.github.io/stars/"><code>stars</code></a>
package, useful to represent <em>vector and raster data cubes</em>, uses the
below approach.</p>
<p>Let’s check whether <strong><a href="https://r-spatial.github.io/sf/"><code>sf</code></a></strong> uses
(for Windows: comes with) the minimal PROJ/GDAL versions that we want!</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">sf::<span style="color:#0a0">sf_extSoftVersion</span>()
</code></pre></div><pre><code>          GEOS           GDAL         proj.4 GDAL_with_GEOS     USE_PROJ_H 
       &quot;3.8.0&quot;        &quot;3.0.4&quot;        &quot;6.3.1&quot;         &quot;true&quot;         &quot;true&quot; 
</code></pre><p>Good to go!</p>
<h4 id="defining-a-crs-with-sf">Defining a CRS with <code>sf</code><a href="#defining-a-crs-with-sf" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>You can simply provide the EPSG code using <code>st_crs()</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">crs_wgs84 &lt;- <span style="color:#0a0">st_crs</span>(<span style="color:#099">4326</span>) <span style="color:#aaa;font-style:italic"># WGS84 has EPSG code 4326</span>
</code></pre></div><p>It is a so-called <code>crs</code> object:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">class</span>(crs_wgs84)
</code></pre></div><pre><code>[1] &quot;crs&quot;
</code></pre>
<h4 id="printing-the-wkt2-string-with-sf">Printing the WKT2 string with <code>sf</code><a href="#printing-the-wkt2-string-with-sf" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>You can directly acces the <code>wkt</code> element of the <code>crs</code> object:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">cat</span>(crs_wgs84$wkt)
</code></pre></div><pre><code>GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&quot;geodetic latitude (Lat)&quot;,north,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        AXIS[&quot;geodetic longitude (Lon)&quot;,east,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;World&quot;],
        BBOX[-90,-180,90,180]],
    ID[&quot;EPSG&quot;,4326]]
</code></pre>
<p>There are a few extras to note:</p>
<ul>
<li>printing the <code>crs</code> object shows us both the EPSG code (more
generally: the user’s CRS specification) and the WKT2 string:</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">crs_wgs84
</code></pre></div><pre><code>Coordinate Reference System:
  User input: EPSG:4326 
  wkt:
GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&quot;geodetic latitude (Lat)&quot;,north,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        AXIS[&quot;geodetic longitude (Lon)&quot;,east,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;World&quot;],
        BBOX[-90,-180,90,180]],
    ID[&quot;EPSG&quot;,4326]]
</code></pre>
<ul>
<li>if the user inputted the CRS with an EPSG code (which we did!), the
latter can be returned as a number:</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">crs_wgs84$epsg
</code></pre></div><pre><code>[1] 4326
</code></pre>
<p>You <em>can</em> (but should you?) export a (stripped) proj4string as well,
with <code>crs_wgs84$proj4string</code>.</p>
<h4 id="set-the-crs-of-an-sf-object">Set the CRS of an <code>sf</code> object<a href="#set-the-crs-of-an-sf-object" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>First we prepare an <code>sf</code> object from <code>cities</code> but still without a CRS:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">cities2 &lt;- <span style="color:#0a0">st_as_sf</span>(cities, coords = <span style="color:#0a0">c</span>(<span style="color:#a50">&#34;</span><span style="color:#a50">X&#34;</span>, <span style="color:#a50">&#34;</span><span style="color:#a50">Y&#34;</span>))
cities2
</code></pre></div><pre><code>Simple feature collection with 606 features and 4 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: -165.27 ymin: -53.15 xmax: 177.1302 ymax: 78.2
CRS:            NA
First 10 features:
               NAME COUNTRY POPULATION CAPITAL                   geometry
1          Murmansk  Russia     468000       N  POINT (33.08604 68.96355)
2       Arkhangelsk  Russia     416000       N  POINT (40.64616 64.52067)
3  Saint Petersburg  Russia    5825000       N  POINT (30.45333 59.95189)
4           Magadan  Russia     152000       N      POINT (150.78 59.571)
5             Perm'  Russia    1160000       N  POINT (56.23246 58.00024)
6     Yekaterinburg  Russia    1620000       N  POINT (60.61013 56.84654)
7  Nizhniy Novgorod  Russia    2025000       N  POINT (43.94067 56.28968)
8           Glasgow      UK    1800000       N POINT (-4.269948 55.86281)
9            Kazan'  Russia    1140000       N  POINT (49.14547 55.73301)
10      Chelyabinsk  Russia    1325000       N    POINT (61.39261 55.145)
</code></pre>
<p>Note the missing CRS!</p>
<p>Let’s add the CRS by using the EPSG code (we could also assign
<code>crs_wgs84</code> instead):</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">st_crs</span>(cities2) &lt;- <span style="color:#099">4326</span>
</code></pre></div><p>Done!</p>
<h4 id="get-the-crs-of-an-sf-object">Get the CRS of an <code>sf</code> object<a href="#get-the-crs-of-an-sf-object" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>Really, all you need is <code>st_crs()</code>, once more!</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">st_crs</span>(cities2)
</code></pre></div><pre><code>Coordinate Reference System:
  User input: EPSG:4326 
  wkt:
GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&quot;geodetic latitude (Lat)&quot;,north,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        AXIS[&quot;geodetic longitude (Lon)&quot;,east,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;World&quot;],
        BBOX[-90,-180,90,180]],
    ID[&quot;EPSG&quot;,4326]]
</code></pre>
<p>Great!</p>
<p>As this returns the <code>crs</code> object, you can also use <code>st_crs(cities2)$wkt</code>
to specifically return the WKT2 string!</p>
<h3 id="sp-package"><code>sp</code> package<a href="#sp-package" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>Note that the actively developed (and matured) <code>sf</code> package is now
recommended over the <code>sp</code> package (a view also shared by <code>sf</code> and <code>sp</code>
developers). The
<strong><a href="https://cran.r-project.org/web/packages/sp/index.html"><code>sp</code></a></strong>
package, which has very long been <em>the</em> go-to package before <code>sf</code>
matured, is maintained in order to support existing code, but it is not
further developed as much.</p>
<p>The <code>sp</code> package relies on the <code>rgdal</code> R package to communicate with
GDAL and PROJ, so let’s check whether <code>rgdal</code> uses (for Windows: comes
with) the minimal PROJ/GDAL versions that we want.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">rgdal::<span style="color:#0a0">rgdal_extSoftVersion</span>()
</code></pre></div><pre><code>          GDAL GDAL_with_GEOS           PROJ             sp 
       &quot;3.0.4&quot;         &quot;TRUE&quot;        &quot;6.3.1&quot;        &quot;1.4-2&quot; 
</code></pre><p>Okido.</p>
<h4 id="defining-a-crs-with-sp">Defining a CRS with <code>sp</code><a href="#defining-a-crs-with-sp" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">crs_wgs84 &lt;- <span style="color:#0a0">CRS</span>(SRS_string = <span style="color:#a50">&#34;</span><span style="color:#a50">EPSG:4326&#34;</span>) <span style="color:#aaa;font-style:italic"># WGS84 has EPSG code 4326</span>
</code></pre></div><p>It is a so-called <code>CRS</code> object:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">class</span>(crs_wgs84)
</code></pre></div><pre><code>[1] &quot;CRS&quot;
attr(,&quot;package&quot;)
[1] &quot;sp&quot;
</code></pre>
<h4 id="printing-the-wkt2-string-with-sp">Printing the WKT2 string with <code>sp</code><a href="#printing-the-wkt2-string-with-sp" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">wkt_wgs84 &lt;- <span style="color:#0a0">wkt</span>(crs_wgs84)
<span style="color:#0a0">cat</span>(wkt_wgs84)
</code></pre></div><pre><code>GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]],
        ID[&quot;EPSG&quot;,6326]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
        ID[&quot;EPSG&quot;,8901]],
    CS[ellipsoidal,2],
        AXIS[&quot;longitude&quot;,east,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                ID[&quot;EPSG&quot;,9122]]],
        AXIS[&quot;latitude&quot;,north,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                ID[&quot;EPSG&quot;,9122]]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;World&quot;],
        BBOX[-90,-180,90,180]]]
</code></pre>
<p>Also note that, when <em>printing</em> a <code>CRS</code> object of <code>sp</code> (e.g. by running
<code>crs_wgs84</code>), you still just get a proj4string (with parts dropped if on
recent GDAL/PROJ)! We won’t print it here! However do know that the
WKT2 string is currently also <em>contained</em> in the <code>CRS</code> object, just call
<code>wkt()</code> to see it.</p>
<h4 id="set-the-crs-of-a-spatial-object-in-sp">Set the CRS of a <code>Spatial*</code> object in <code>sp</code><a href="#set-the-crs-of-a-spatial-object-in-sp" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>First we prepare a <code>SpatialPointsDataFrame</code> from <code>cities</code> but still
without a CRS:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">cities2 &lt;- cities
<span style="color:#0a0">coordinates</span>(cities2) &lt;-  ~ X + Y
</code></pre></div><p>Now, we can add a CRS:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">proj4string</span>(cities2) &lt;- crs_wgs84
</code></pre></div><p>Note the name of the <code>proj4string&lt;-</code> replacement function in <code>sp</code>: it
still reminds of old days, but the result is GDAL3/PROJ≥6 compliant!
Maybe we’ll get another function in the future that cuts the link with
the ‘proj4string’ name.</p>
<h4 id="get-the-crs-of-a-spatial-object-in-sp">Get the CRS of a <code>Spatial*</code> object in <code>sp</code><a href="#get-the-crs-of-a-spatial-object-in-sp" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>Again, use <code>wkt()</code>: it works on both <code>CRS</code> and <code>Spatial*</code> objects!</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">cat</span>(<span style="color:#0a0">wkt</span>(cities2))
</code></pre></div><pre><code>GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]],
        ID[&quot;EPSG&quot;,6326]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
        ID[&quot;EPSG&quot;,8901]],
    CS[ellipsoidal,2],
        AXIS[&quot;longitude&quot;,east,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                ID[&quot;EPSG&quot;,9122]]],
        AXIS[&quot;latitude&quot;,north,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                ID[&quot;EPSG&quot;,9122]]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;World&quot;],
        BBOX[-90,-180,90,180]]]
</code></pre>
<p>Et voilà!</p>
<h3 id="raster-package"><code>raster</code> package<a href="#raster-package" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>At the time of writing, you still needed the development version of
<code>raster</code> for the below code to run. You can install the development
version with: <code>remotes::install_github(&quot;rspatial/raster&quot;)</code>. If below
code does not run with the CRAN version (usually obtained with
<code>install.packages()</code>), use the development version. Further, be aware
that a <a href="https://rspatial.org/terra/pkg/"><code>terra</code></a> package is in
development as a successor to <code>raster</code>. It is aimed at faster processing
and it is <em>only</em> compatible with GDAL3/PROJ≥6.</p>
<p>As you will see, <strong><a href="https://rspatial.org/raster/pkg/"><code>raster</code></a></strong> more
or less aligns with <code>sp</code>, although it has a few extras. For example:
<code>raster</code> does not require the use of the <code>proj4string&lt;-</code> replacement
function to set the CRS. <code>raster</code> provides <code>crs&lt;-</code>.</p>
<p>Let’s make a dummy raster first, without CRS:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">within_belgium &lt;- 
  <span style="color:#0a0">raster</span>(<span style="color:#0a0">extent</span>(<span style="color:#099">188500</span>, <span style="color:#099">190350</span>, <span style="color:#099">227550</span>, <span style="color:#099">229550</span>),
         res = <span style="color:#099">50</span>)
<span style="color:#0a0">values</span>(within_belgium) &lt;- <span style="color:#099">1</span>:<span style="color:#0a0">ncell</span>(within_belgium)
within_belgium
</code></pre></div><pre><code>class      : RasterLayer 
dimensions : 40, 37, 1480  (nrow, ncol, ncell)
resolution : 50, 50  (x, y)
extent     : 188500, 190350, 227550, 229550  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : layer 
values     : 1, 1480  (min, max)
</code></pre>
<p>This raster is intended for use in the Belgian Lambert 72 CRS (EPSG
31370).</p>
<h4 id="defining-and-printing-a-crs-with-raster">Defining and printing a CRS with <code>raster</code><a href="#defining-and-printing-a-crs-with-raster" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>This is not applicable. Just use the facilities of the <code>sp</code> package if
you want to make a separate CRS object for usage in a <code>Raster*</code> object
(see below).</p>
<h4 id="set-the-crs-of-a-raster-object-in-raster">Set the CRS of a <code>Raster*</code> object in <code>raster</code><a href="#set-the-crs-of-a-raster-object-in-raster" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>We prepare a few copies of the data:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">within_belgium1 &lt;- within_belgium
within_belgium2 &lt;- within_belgium
within_belgium3 &lt;- within_belgium
within_belgium4 &lt;- within_belgium
</code></pre></div><p>Setting the CRS is done with the <code>crs&lt;-</code> replacement function. It can
take a multitude of formats; these are all equivalent:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">crs</span>(within_belgium1) &lt;- <span style="color:#099">31370</span>
<span style="color:#0a0">crs</span>(within_belgium2) &lt;- <span style="color:#a50">&#34;</span><span style="color:#a50">EPSG:31370&#34;</span>
<span style="color:#0a0">crs</span>(within_belgium3) &lt;- <span style="color:#0a0">st_crs</span>(<span style="color:#099">31370</span>)$wkt <span style="color:#aaa;font-style:italic"># a WKT string</span>
<span style="color:#0a0">crs</span>(within_belgium4) &lt;- <span style="color:#0a0">CRS</span>(SRS_string = <span style="color:#a50">&#34;</span><span style="color:#a50">EPSG:31370&#34;</span>) <span style="color:#aaa;font-style:italic"># an sp CRS object</span>
</code></pre></div><p>Note that we could also have provided the <code>crs</code> argument in <code>raster()</code>,
when creating the <code>RasterLayer</code> object. It can take any of the above
formats.</p>
<h4 id="get-the-crs-of-a-raster-object-in-raster">Get the CRS of a <code>Raster*</code> object in <code>raster</code><a href="#get-the-crs-of-a-raster-object-in-raster" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>It goes the same as in <code>sp</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">cat</span>(<span style="color:#0a0">wkt</span>(within_belgium1))
</code></pre></div><pre><code>PROJCRS[&quot;Belge 1972 / Belgian Lambert 72&quot;,
    BASEGEOGCRS[&quot;Belge 1972&quot;,
        DATUM[&quot;Reseau National Belge 1972&quot;,
            ELLIPSOID[&quot;International 1924&quot;,6378388,297,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4313]],
    CONVERSION[&quot;Belgian Lambert 72&quot;,
        METHOD[&quot;Lambert Conic Conformal (2SP)&quot;,
            ID[&quot;EPSG&quot;,9802]],
        PARAMETER[&quot;Latitude of false origin&quot;,90,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8821]],
        PARAMETER[&quot;Longitude of false origin&quot;,4.36748666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8822]],
        PARAMETER[&quot;Latitude of 1st standard parallel&quot;,51.1666672333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8823]],
        PARAMETER[&quot;Latitude of 2nd standard parallel&quot;,49.8333339,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8824]],
        PARAMETER[&quot;Easting at false origin&quot;,150000.013,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8826]],
        PARAMETER[&quot;Northing at false origin&quot;,5400088.438,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8827]],
        ID[&quot;EPSG&quot;,19961]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;Belgium - onshore&quot;],
        BBOX[49.5,2.5,51.51,6.4]]]
</code></pre>
<p>Let’s verify whether all objects do indeed have the same CRS:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">all.equal</span>(<span style="color:#0a0">wkt</span>(within_belgium1),
          <span style="color:#0a0">wkt</span>(within_belgium2),
          <span style="color:#0a0">wkt</span>(within_belgium3),
          <span style="color:#0a0">wkt</span>(within_belgium4))
</code></pre></div><pre><code>[1] TRUE
</code></pre>
<p>YES!</p>
<h2 id="literature">Literature<a href="#literature" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Bivand R. (2019). ECS530: (III) Coordinate reference systems. Tuesday 3
December 2019, 09:15-11.00, aud. C [WWW document].
<a href="https://rsbivand.github.io/ECS530_h19/ECS530_III.html#coordinate_reference_systems:_background">https://rsbivand.github.io/ECS530_h19/ECS530_III.html#coordinate_reference_systems:_background</a>
(accessed September 16, 2020).</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Bivand R. (2020a). Migration to PROJ6/GDAL3 [WWW document].
<a href="http://rgdal.r-forge.r-project.org/articles/PROJ6_GDAL3.html">http://rgdal.r-forge.r-project.org/articles/PROJ6_GDAL3.html</a> (accessed
September 21, 2020).</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Bivand R. (2020b). Upstream software dependencies of the R-spatial
ecosystem (video recording). In: How R Helped Provide Tools for Spatial
Data Analysis @ CelebRation 2020 [WWW document].
<a href="https://youtu.be/D4-roPsMz48?t=2166">https://youtu.be/D4-roPsMz48?t=2166</a> (accessed September 21, 2020).</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Bivand R. (2020c). How R Helped Provide Tools for Spatial Data Analysis.
<a href="https://github.com/rsbivand/celebRation20_files/raw/master/bivand_200229.pdf">https://github.com/rsbivand/celebRation20_files/raw/master/bivand_200229.pdf</a>.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Nowosad J. &amp; Lovelace R. (2020). Recent changes in R spatial and how to
be ready for them [WWW document].
<a href="https://geocompr.github.io/post/2020/whyr_webinar004/">https://geocompr.github.io/post/2020/whyr_webinar004/</a> (accessed
September 21, 2020).</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Pebesma E. &amp; Bivand R. (2020). R spatial follows GDAL and PROJ
development [WWW document].
<a href="https://www.r-spatial.org/r/2020/03/17/wkt.html">https://www.r-spatial.org/r/2020/03/17/wkt.html</a> (accessed September
21, 2020).</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ol>
<li>
<p>The core geospatial R packages are aware of the GDAL/PROJ versions,
in order to properly communicate with these.</p>
</li>
<li>
<p>In order to emphasize the fact that the improvements in version 2
were instructive to the new versions of GDAL and PROJ, you will
often see explicit mention of ‘WKT2’.</p>
</li>
<li>
<p>The packages give a warning especially to make developers of
<em>other</em>, dependent packages <em>aware</em> that they should also make sure
their functions do not <em>require</em> proj4strings or use hardcoded
proj4strings. Instead, they should defer the handling of CRS
representation to the basic geospatial R packages (i.e. dependent on
the version of PROJ/GDAL). So, the appearance of these warnings
marks a period of transition in order to let other packages become
GDAL 3 and PROJ ≥ 6 compliant. And the good news is that most
popular geospatial packages <em>have</em> become GDAL 3 and PROJ ≥ 6
compliant!</p>
</li>
</ol>
</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
<span class='screen-reader-text'>Categories: </span><a class='category' href='/tutorials/categories/r/'>r</a>, <a class='category' href='/tutorials/categories/gis/'>gis</a></div>
<div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tutorials/tags/gis/'>gis</a>, <a class='tag' href='/tutorials/tags/r/'>r</a>, <a class='tag' href='/tutorials/tags/maps/'>maps</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/tutorials/tutorials/spatial_standards_raster/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>How to use open raster file formats in R: GeoTIFF &amp; GeoPackage</a>
    </div><div class='next-entry sep-before'>
      <a href='/tutorials/tutorials/r_google_sheets/'>
        <span class='screen-reader-text'>Next post: </span>Read data from Google sheets<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p> &copy; 2018-2021 Research Institute for Nature and Forest (INBO) <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__public_path__='\/tutorials\/assets\/js\/'</script>

<script src='/tutorials/assets/js/main.00df04b7.js'></script><script src='/tutorials/js/custom.js'></script>

</body>

</html>

