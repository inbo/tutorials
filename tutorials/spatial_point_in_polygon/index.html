<!DOCTYPE html>
<html lang='en' dir='auto'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Various ways to make a spatial join between GIS point data and polygon data'>
<meta name='theme-color' content='#c04384'>

<meta property='og:title' content='How to make spatial joins (point in polygon)? • Stijn Van Hoey'>
<meta property='og:description' content='Various ways to make a spatial join between GIS point data and polygon data'>
<meta property='og:url' content='/tutorials/spatial_point_in_polygon/'>
<meta property='og:site_name' content='INBO Tutorials'>
<meta property='og:type' content='article'><meta property='article:section' content='tutorials'><meta property='article:tag' content='gis'><meta property='article:tag' content='r'><meta property='article:tag' content='maps'><meta property='article:published_time' content='2019-06-20T00:00:00Z'/><meta property='article:modified_time' content='2019-06-20T00:00:00Z'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.88.1" />

  <title>How to make spatial joins (point in polygon)? • Stijn Van Hoey</title>
  <link rel='canonical' href='/tutorials/spatial_point_in_polygon/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.ab98e12b.css'><link rel='stylesheet' href='/css/custom.css'><style>
:root{--color-accent:#c04384;}
</style>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        {left: '\\[', right: '\\]', display: true},   
        {left: '$$', right: '$$', display: true},     
        {left: '\\(', right: '\\)', display: false},  
      ],
      throwOnError : false
    });
  });
</script>



</head>
<body class='page type-tutorials has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/'>
        <img src='/images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
      <a href='/'>
       
      </a>
    </h2>
    <div class='desc'>
    
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'> </h4>
  </header>

  <form action='/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='/'>Home</a></li><li class='item'>
  <a href='/articles/'>Articles</a></li><li class='item has-current'>
  <a href='/tutorials/'>Tutorials</a></li><li class='item'>
  <a href='/create_tutorial/'>Create tutorial</a></li><li class='item has-children'>
  <a href='/installation/'>Installation</a><button class='sub-menu-toggler'>
    <span class='screen-reader-text'>expand sub menu</span>
    <span class='sign'></span>
  </button>

  <ul class='sub-menu'><li class='item'>
  <a href='/installation/administrator/'>For admins</a></li><li class='item'>
  <a href='/installation/user/'>For users</a></li></ul></li><li class='item'>
  <a href='/categories/'>Categories</a></li><li class='item'>
  <a href='https://github.com/inbo/tutorials'>Repository</a></li></ul>
    </div>
  </nav>

</section><section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud no-shuffle'><li>
        <a href='/tags/analysis/' style='font-size:1.0632911392405062em'>analysis</a>
      </li><li>
        <a href='/tags/analysis-of-variance/' style='font-size:1em'>analysis of variance</a>
      </li><li>
        <a href='/tags/api/' style='font-size:1.0126582278481013em'>api</a>
      </li><li>
        <a href='/tags/bibliography/' style='font-size:1.0126582278481013em'>bibliography</a>
      </li><li>
        <a href='/tags/binning/' style='font-size:1em'>binning</a>
      </li><li>
        <a href='/tags/biodiversity/' style='font-size:1.0126582278481013em'>biodiversity</a>
      </li><li>
        <a href='/tags/biorad/' style='font-size:1em'>bioRad</a>
      </li><li>
        <a href='/tags/bookdown/' style='font-size:1.0126582278481013em'>bookdown</a>
      </li><li>
        <a href='/tags/brms/' style='font-size:1em'>brms</a>
      </li><li>
        <a href='/tags/checklist/' style='font-size:1.0253164556962024em'>checklist</a>
      </li><li>
        <a href='/tags/ci/' style='font-size:1.0126582278481013em'>ci</a>
      </li><li>
        <a href='/tags/co-variance/' style='font-size:1em'>co-variance</a>
      </li><li>
        <a href='/tags/coding-club/' style='font-size:1em'>coding club</a>
      </li><li>
        <a href='/tags/csl/' style='font-size:1.0126582278481013em'>csl</a>
      </li><li>
        <a href='/tags/data/' style='font-size:1.0253164556962024em'>data</a>
      </li><li>
        <a href='/tags/database/' style='font-size:1.0506329113924051em'>database</a>
      </li><li>
        <a href='/tags/de-trending/' style='font-size:1em'>de-trending</a>
      </li><li>
        <a href='/tags/development/' style='font-size:1.0126582278481013em'>development</a>
      </li><li>
        <a href='/tags/dplyr/' style='font-size:1em'>dplyr</a>
      </li><li>
        <a href='/tags/e-book/' style='font-size:1em'>e-book</a>
      </li><li>
        <a href='/tags/effectclass/' style='font-size:1.0253164556962024em'>effectclass</a>
      </li><li>
        <a href='/tags/endnote/' style='font-size:1em'>endnote</a>
      </li><li>
        <a href='/tags/etn/' style='font-size:1em'>etn</a>
      </li><li>
        <a href='/tags/explorative-data-analysis/' style='font-size:1em'>explorative data analysis</a>
      </li><li>
        <a href='/tags/frictionless/' style='font-size:1em'>frictionless</a>
      </li><li>
        <a href='/tags/gbif/' style='font-size:1.0126582278481013em'>gbif</a>
      </li><li>
        <a href='/tags/generalized-linear-regression/' style='font-size:1.0126582278481013em'>generalized linear regression</a>
      </li><li>
        <a href='/tags/ggplot2/' style='font-size:1.0126582278481013em'>ggplot2</a>
      </li><li>
        <a href='/tags/gis/' style='font-size:1.139240506329114em'>gis</a>
      </li><li>
        <a href='/tags/git/' style='font-size:1.1265822784810127em'>git</a>
      </li><li>
        <a href='/tags/gitbook/' style='font-size:1.0126582278481013em'>gitbook</a>
      </li><li>
        <a href='/tags/github/' style='font-size:1.0379746835443038em'>github</a>
      </li><li>
        <a href='/tags/google/' style='font-size:1.0126582278481013em'>google</a>
      </li><li>
        <a href='/tags/grids/' style='font-size:1em'>grids</a>
      </li><li>
        <a href='/tags/gwlogger/' style='font-size:1.0379746835443038em'>gwloggeR</a>
      </li><li>
        <a href='/tags/inbodb/' style='font-size:1.0253164556962024em'>inbodb</a>
      </li><li>
        <a href='/tags/inbomd/' style='font-size:1.0379746835443038em'>INBOmd</a>
      </li><li>
        <a href='/tags/inborutils/' style='font-size:1.0379746835443038em'>inborutils</a>
      </li><li>
        <a href='/tags/inla/' style='font-size:1.0253164556962024em'>INLA</a>
      </li><li>
        <a href='/tags/inlabru/' style='font-size:1em'>inlabru</a>
      </li><li>
        <a href='/tags/inlatools/' style='font-size:1.0253164556962024em'>inlatools</a>
      </li><li>
        <a href='/tags/installation/' style='font-size:1.1139240506329113em'>installation</a>
      </li><li>
        <a href='/tags/literature/' style='font-size:1.0506329113924051em'>literature</a>
      </li><li>
        <a href='/tags/maps/' style='font-size:1.0759493670886076em'>maps</a>
      </li><li>
        <a href='/tags/markdown/' style='font-size:1.0253164556962024em'>markdown</a>
      </li><li>
        <a href='/tags/mendeley/' style='font-size:1em'>mendeley</a>
      </li><li>
        <a href='/tags/mgrs/' style='font-size:1em'>mgrs</a>
      </li><li>
        <a href='/tags/mixed-model/' style='font-size:1.0632911392405062em'>mixed model</a>
      </li><li>
        <a href='/tags/mixed-models/' style='font-size:1em'>mixed models</a>
      </li><li>
        <a href='/tags/multivariate-statistics/' style='font-size:1em'>multivariate statistics</a>
      </li><li>
        <a href='/tags/n2khab/' style='font-size:1.0506329113924051em'>n2khab</a>
      </li><li>
        <a href='/tags/open-science/' style='font-size:1.0886075949367089em'>open science</a>
      </li><li>
        <a href='/tags/packages/' style='font-size:1.0379746835443038em'>packages</a>
      </li><li>
        <a href='/tags/pandoc/' style='font-size:1.0126582278481013em'>pandoc</a>
      </li><li>
        <a href='/tags/python/' style='font-size:1em'>python</a>
      </li><li>
        <a href='/tags/r/' style='font-size:2em'>r</a>
      </li><li>
        <a href='/tags/regression/' style='font-size:1em'>regression</a>
      </li><li>
        <a href='/tags/renv/' style='font-size:1em'>renv</a>
      </li><li>
        <a href='/tags/reports/' style='font-size:1.0126582278481013em'>reports</a>
      </li><li>
        <a href='/tags/rgbif/' style='font-size:1.0632911392405062em'>rgbif</a>
      </li><li>
        <a href='/tags/rmarkdown/' style='font-size:1.0253164556962024em'>rmarkdown</a>
      </li><li>
        <a href='/tags/rstudio/' style='font-size:1.0506329113924051em'>rstudio</a>
      </li><li>
        <a href='/tags/spatial/' style='font-size:1em'>spatial</a>
      </li><li>
        <a href='/tags/spreadsheet/' style='font-size:1em'>spreadsheet</a>
      </li><li>
        <a href='/tags/sql/' style='font-size:1em'>SQL</a>
      </li><li>
        <a href='/tags/stan/' style='font-size:1em'>stan</a>
      </li><li>
        <a href='/tags/styleguide/' style='font-size:1.0379746835443038em'>styleguide</a>
      </li><li>
        <a href='/tags/tidyverse/' style='font-size:1.0379746835443038em'>tidyverse</a>
      </li><li>
        <a href='/tags/uncertainty/' style='font-size:1.0126582278481013em'>uncertainty</a>
      </li><li>
        <a href='/tags/utm/' style='font-size:1em'>utm</a>
      </li><li>
        <a href='/tags/version-control/' style='font-size:1.1012658227848102em'>version control</a>
      </li><li>
        <a href='/tags/vignette/' style='font-size:1.481012658227848em'>vignette</a>
      </li><li>
        <a href='/tags/visual-markdown-editing/' style='font-size:1em'>visual markdown editing</a>
      </li><li>
        <a href='/tags/vmm/' style='font-size:1em'>vmm</a>
      </li><li>
        <a href='/tags/waterinfo/' style='font-size:1.0253164556962024em'>wateRinfo</a>
      </li><li>
        <a href='/tags/watina/' style='font-size:1.0253164556962024em'>watina</a>
      </li><li>
        <a href='/tags/webservice/' style='font-size:1.0379746835443038em'>webservice</a>
      </li><li>
        <a href='/tags/windows/' style='font-size:1em'>windows</a>
      </li><li>
        <a href='/tags/zenodo/' style='font-size:1em'>zenodo</a>
      </li><li>
        <a href='/tags/zotero/' style='font-size:1.0126582278481013em'>zotero</a>
      </li></ul>
</div>


</section>
<section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/inbo' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://facebook.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Facebook account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section>
<section class='widget widget-build_time sep-after'>
  <p><small>Built on: Mon Mar 31 10:09:05 UTC 2025</small></p>
</section></div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button><div class='header-widgets'>
        <div class='container'>
    
    <style>.widget-breadcrumbs li:after{content:'\2f '}</style>
  <section class='widget widget-breadcrumbs sep-after'>
    <nav id='breadcrumbs'>
      <ol><li><a href='/'>Home</a></li><li><a href='/tutorials/'>Tutorials</a></li><li><span>How to make spatial joins (point in polygon)?</span></li></ol>
    </nav>
  </section></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>INBO Tutorials</p><p class='desc site-desc'></p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>How to make spatial joins (point in polygon)?</h1>
      
<p class='desc'>Various ways to make a spatial join between GIS point data and polygon data</p>


    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2019-06-20T00:00:00Z'>2019, Jun 20</time>
</span>

  <span class='byline'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
  <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
  
</svg>
<span class='screen-reader-text'> by </span><a href='/authors/stijnvanhoey'>Stijn Van Hoey</a>, <a href='/authors/hansvancalster'>Hans Van Calster</a></span>
  <br/>
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
11 mins read
</span>


  <span class="github-link">

    

        

        
            
        

        
            <a href='https://github.com/inbo/tutorials/edit/master/content/tutorials/spatial_point_in_polygon/index.Rmd'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
Improve this page</a>
        

        
    
</span>

</div>


  </div>
</header>

  
  

  <div class='container entry-content'><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">library</span>(R.utils)
<span style="color:#0a0">library</span>(rgdal)
<span style="color:#0a0">library</span>(tidyverse)
<span style="color:#0a0">library</span>(leaflet)
<span style="color:#0a0">library</span>(sp)
<span style="color:#0a0">library</span>(sf)
<span style="color:#0a0">library</span>(rgbif)
<span style="color:#0a0">library</span>(DBI)
</code></pre></div><h2 id="what-we-want-to-do">What we want to do<a href="#what-we-want-to-do" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>In this short tutorial, we explore various options to deal with the
situation where we have (1) a spatially referenced GIS file with
polygons and (2) a spatially referenced set of points that overlaps with
the GIS polygons.</p>
<p>Typically, both data sources contain information (apart from the spatial
locations) that needs to be related to each other in some way. In this
case study, we want to know for each point in which polygon it is
located.</p>
<h2 id="get-some-data-to-work-with">Get some data to work with<a href="#get-some-data-to-work-with" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>For the point data, we will work with data on the invasive species -
Chinese mitten crab (<strong>Eriocheir sinensis</strong>) in Flanders, Belgium, from
the year 2008 (GBIF.org (20th June 2019) GBIF Occurrence Download
<a href="https://doi.org/10.15468/dl.decefb">https://doi.org/10.15468/dl.decefb</a>).</p>
<p>We will use convenience functions from the <code>rgbif</code> package to download
the data as a zip file and to import the data as a <code>tibble</code> in the R
environment.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">invasive_species &lt;- <span style="color:#0a0">occ_download_get</span>(<span style="color:#a50">&#34;0032582-190415153152247&#34;</span>,
                                     path = <span style="color:#0a0">tempdir</span>(),
                                     overwrite = <span style="color:#00a">TRUE</span>) %&gt;% 
  <span style="color:#0a0">occ_download_import</span>() %&gt;%
  <span style="color:#0a0">filter</span>(!<span style="color:#0a0">is.na</span>(decimalLongitude), !<span style="color:#0a0">is.na</span>(decimalLatitude))
</code></pre></div><pre><code>## Download file size: 0.01 MB

## On disk at /var/folders/c2/7_7qg3r93993m4kk3kjqgj2n76h_tn/T//RtmpYC9cBo/0032582-190415153152247.zip
</code></pre>
<p>We will use the European reference grid system from the European
Environmental Agency as an example of a GIS vector layer (each grid cell
is a polygon). The Belgian part of the grid system can be downloaded as
a sqlite/spatialite database from the EEA website using the following
code:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic"># explicitly set mode = &#34;wb&#34;, otherwise zip file will be corrupt</span>
<span style="color:#0a0">download.file</span>(<span style="color:#a50">&#34;https://www.eea.europa.eu/data-and-maps/data/eea-reference-grids-2/gis-files/belgium-spatialite/at_download/file&#34;</span>, destfile = <span style="color:#0a0">file.path</span>(<span style="color:#0a0">tempdir</span>(), <span style="color:#a50">&#34;Belgium_spatialite.zip&#34;</span>), mode = <span style="color:#a50">&#34;wb&#34;</span>)

<span style="color:#aaa;font-style:italic"># this will extract a file Belgium.sqlite to the temporary folder</span>
<span style="color:#0a0">unzip</span>(zipfile = <span style="color:#0a0">file.path</span>(<span style="color:#0a0">tempdir</span>(), <span style="color:#a50">&#34;Belgium_spatialite.zip&#34;</span>), exdir = <span style="color:#0a0">tempdir</span>())  
</code></pre></div><h2 id="point-in-polygon-with-the-sf-package">Point in polygon with the <code>sf</code> package<a href="#point-in-polygon-with-the-sf-package" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The spatial query can be done with the aid of the <a href="https://r-spatial.github.io/sf/"><code>sf</code>
package</a>. The package has built-in
functions to read spatial data (which uses GDAL as backbone).</p>
<p>We will project the data to Belgian Lambert 72
(<a href="https://epsg.io/31370">https://epsg.io/31370</a>), because the join assumes planar coordinates.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">be10grid &lt;- <span style="color:#0a0">read_sf</span>(<span style="color:#0a0">file.path</span>(<span style="color:#0a0">tempdir</span>(), <span style="color:#a50">&#34;Belgium.sqlite&#34;</span>), 
                    layer = <span style="color:#a50">&#34;be_10km&#34;</span>)  %&gt;%
  <span style="color:#aaa;font-style:italic"># convert to Belgian Lambert 72</span>
  <span style="color:#0a0">st_transform</span>(crs = <span style="color:#099">31370</span>)
</code></pre></div><p>We now get a <code>sf</code> object which is also a <code>data.frame</code> and a <code>tbl</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">class</span>(be10grid)
</code></pre></div><pre><code>## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;
</code></pre>
<p>Let’s have a look at this object:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">be10grid
</code></pre></div><pre><code>## Simple feature collection with 580 features and 3 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -22402.56 ymin: -1449.985 xmax: 311353.3 ymax: 305932.2
## Projected CRS: Belge 1972 / Belgian Lambert 72
## # A tibble: 580 × 4
##    cellcode     eoforigin noforigin                                     GEOMETRY
##  * &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;                                &lt;POLYGON [m]&gt;
##  1 10kmE376N318   3760000   3180000 ((-20851.02 240718.4, -21626.25 250679.5, -…
##  2 10kmE376N319   3760000   3190000 ((-21626.25 250679.5, -22402.56 260640.9, -…
##  3 10kmE377N314   3770000   3140000 ((-7781.475 201650, -8552.253 211611, 1426.…
##  4 10kmE377N315   3770000   3150000 ((-8552.253 211611, -9324.075 221572.1, 655…
##  5 10kmE377N316   3770000   3160000 ((-9324.075 221572.1, -10096.95 231533.3, -…
##  6 10kmE377N317   3770000   3170000 ((-10096.95 231533.3, -10870.87 241494.6, -…
##  7 10kmE377N318   3770000   3180000 ((-10870.87 241494.6, -11645.85 251456.1, -…
##  8 10kmE377N319   3770000   3190000 ((-11645.85 251456.1, -12421.9 261417.9, -2…
##  9 10kmE377N320   3770000   3200000 ((-12421.9 261417.9, -13199.02 271379.8, -3…
## 10 10kmE377N321   3770000   3210000 ((-13199.02 271379.8, -13977.21 281342.1, -…
## # … with 570 more rows
</code></pre>
<p>We can see that the spatial information resides in a <code>GEOMETRY</code> list
column.</p>
<p>Similarly, the package has built-in functions to convert a <code>data.frame</code>
containing coordinates to a spatial <code>sf</code> object:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">invasive_spatial &lt;- <span style="color:#0a0">st_as_sf</span>(invasive_species,
                             coords = <span style="color:#0a0">c</span>(<span style="color:#a50">&#34;decimalLongitude&#34;</span>,
                                        <span style="color:#a50">&#34;decimalLatitude&#34;</span>),
                             crs = <span style="color:#099">4326</span>) %&gt;%
  <span style="color:#aaa;font-style:italic"># convert to Lambert72</span>
  <span style="color:#0a0">st_transform</span>(crs = <span style="color:#099">31370</span>)
</code></pre></div><p>Resulting in:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">invasive_spatial
</code></pre></div><pre><code>## Simple feature collection with 513 features and 43 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 35125.7 ymin: 188235.3 xmax: 153743.2 ymax: 220135
## Projected CRS: Belge 1972 / Belgian Lambert 72
## # A tibble: 513 × 44
##        gbifID datasetKey   occurrenceID  kingdom phylum class order family genus
##  *      &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;
##  1 1146738051 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
##  2 1146738044 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
##  3 1146738029 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
##  4 1146738026 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
##  5 1146737979 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
##  6 1146737949 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
##  7 1146737902 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
##  8 1146737751 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
##  9 1146737736 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
## 10 1146737717 258c9ce5-1b… INBO:VIS:007… Animal… Arthr… Mala… Deca… Pseud… Erio…
## # … with 503 more rows, and 35 more variables: species &lt;chr&gt;,
## #   infraspecificEpithet &lt;lgl&gt;, taxonRank &lt;chr&gt;, scientificName &lt;chr&gt;,
## #   countryCode &lt;chr&gt;, locality &lt;lgl&gt;, publishingOrgKey &lt;chr&gt;,
## #   coordinateUncertaintyInMeters &lt;dbl&gt;, coordinatePrecision &lt;lgl&gt;,
## #   elevation &lt;lgl&gt;, elevationAccuracy &lt;lgl&gt;, depth &lt;lgl&gt;, depthAccuracy &lt;lgl&gt;,
## #   eventDate &lt;dttm&gt;, day &lt;int&gt;, month &lt;int&gt;, year &lt;int&gt;, taxonKey &lt;int&gt;,
## #   speciesKey &lt;int&gt;, basisOfRecord &lt;chr&gt;, institutionCode &lt;chr&gt;, …
</code></pre>
<p>Now we are ready to make the spatial overlay. This is done with the aid
of <code>sf::st_join</code>. The default join type is <code>st_intersects</code>. This will
result in the same spatial overlay as <code>sp::over</code> (see next section). We
join the information from the grid to the points through a left join.
See <a href="https://en.wikipedia.org/wiki/DE-9IM">the DE-9IM topological model</a>
for explanations about all possible spatial joins.</p>
<p>Note that with <code>st_intersects</code> points on a polygon boundary and points
corresponding to a polygon vertex are considered to be inside the
polygon. In the case where points are joined with polygons,
<code>st_intersects</code> and <code>st_covered_by</code> will give the same result. The join
type <code>st_within</code> can be used if we want to join only when points are
completely within (excluding polygon boundary).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">invasive_be10grid_sf &lt;- invasive_spatial %&gt;%
  <span style="color:#0a0">st_join</span>(be10grid,
          join = st_intersects, 
          left = <span style="color:#00a">TRUE</span>) %&gt;%
  <span style="color:#0a0">select</span>(-eoforigin, -noforigin)  <span style="color:#aaa;font-style:italic"># exclude the EofOrigin NofOrigin columns</span>
</code></pre></div><p>Looking at selected columns of the resulting object:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">invasive_be10grid_sf %&gt;%
  <span style="color:#0a0">select</span>(species, eventDate, cellcode, geometry)
</code></pre></div><pre><code>## Simple feature collection with 513 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 35125.7 ymin: 188235.3 xmax: 153743.2 ymax: 220135
## Projected CRS: Belge 1972 / Belgian Lambert 72
## # A tibble: 513 × 4
##    species            eventDate           cellcode                geometry
##    &lt;chr&gt;              &lt;dttm&gt;              &lt;chr&gt;                &lt;POINT [m]&gt;
##  1 Eriocheir sinensis 2008-09-17 00:00:00 10kmE392N312 (143788.9 201487.1)
##  2 Eriocheir sinensis 2008-06-03 00:00:00 10kmE392N312 (143788.9 201487.1)
##  3 Eriocheir sinensis 2008-03-20 00:00:00 10kmE389N311 (114822.9 188235.3)
##  4 Eriocheir sinensis 2008-07-03 00:00:00 10kmE393N311 (153743.2 191634.8)
##  5 Eriocheir sinensis 2008-09-17 00:00:00 10kmE392N312 (143788.9 201487.1)
##  6 Eriocheir sinensis 2008-04-10 00:00:00 10kmE392N312 (147138.3 199035.5)
##  7 Eriocheir sinensis 2008-03-13 00:00:00 10kmE381N314  (35125.7 205808.5)
##  8 Eriocheir sinensis 2008-03-19 00:00:00 10kmE391N312 (136197.7 197300.8)
##  9 Eriocheir sinensis 2008-03-19 00:00:00 10kmE391N312 (136197.7 197300.8)
## 10 Eriocheir sinensis 2008-10-28 00:00:00 10kmE389N311 (121593.8 190203.2)
## # … with 503 more rows
</code></pre>
<h2 id="point-in-polygon-with-the-sp-package">Point in polygon with the <code>sp</code> package<a href="#point-in-polygon-with-the-sp-package" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p><em>General note: migration to the more actively developed <code>sf</code> package is
currently advised by the <code>sp</code> maintainer.</em> <em>The <code>sp</code> package is still
maintained in order to support the newest versions of the GDAL and PROJ
backends.</em></p>
<p>Instead of <code>sf</code> objects (= <code>data.frames</code> or <code>tibbles</code> with a geometry
list-column), the <code>sp</code> package works with <code>Spatial</code> spatial data classes
(which has many derived spatial data classes for points, polygons, …).</p>
<p>First, we need to convert the <code>data.frame</code> with point locations to a
<code>SpatialPointsDataFrame</code>. We also need to ensure that the coordinate
reference system (CRS) for both the point locations and the grid is the
same. The data from GBIF are in WGS84 format.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">crs_wgs84 &lt;- <span style="color:#0a0">CRS</span>(SRS_string = <span style="color:#a50">&#34;EPSG:4326&#34;</span>)
coord &lt;- invasive_species %&gt;%
    <span style="color:#0a0">select</span>(decimalLongitude, decimalLatitude)
invasive_spatial &lt;- <span style="color:#0a0">SpatialPointsDataFrame</span>(coord,
                                           data = invasive_species,
                                           proj4string = crs_wgs84)
</code></pre></div><p>The <code>sp</code> package has no native methods to read the Belgium 10 km x 10 km
grid, but we can use <code>rgdal::readOGR</code> to connect with the
sqlite/spatialite database and extract the Belgium 10 km x 10 km grid as
a <code>SpatialPolygonsDataFrame</code>. Apart from the 10 km x 10 km grid, the
database also contains 1 km x 1 km and 100 km x 100 km grids as raster
or vector files.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">be10grid &lt;- <span style="color:#0a0">readOGR</span>(dsn = <span style="color:#0a0">file.path</span>(<span style="color:#0a0">tempdir</span>(), <span style="color:#a50">&#34;Belgium.sqlite&#34;</span>), 
                  layer = <span style="color:#a50">&#34;be_10km&#34;</span>)
</code></pre></div><pre><code>## Warning in OGRSpatialRef(dsn, layer, morphFromESRI = morphFromESRI, dumpSRS
## = dumpSRS, : Discarded datum European_Terrestrial_Reference_System_1989 in
## Proj4 definition: +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
## +ellps=GRS80 +units=m +no_defs

## OGR data source with driver: SQLite 
## Source: &quot;/private/var/folders/c2/7_7qg3r93993m4kk3kjqgj2n76h_tn/T/RtmpYC9cBo/Belgium.sqlite&quot;, layer: &quot;be_10km&quot;
## with 580 features
## It has 3 fields
</code></pre>
<p>Note the warning: it is because some PROJ.4 information, i.e. the string
to represent the coordinate reference system, is not supported anymore
in the current geospatial GDAL and PROJ libraries (the background
workhorses for spatial R packages). The spatialite database from the EEA
website (with the 10 km x 10 km grid) still uses the older PROJ.4 string
. Because the <code>rgdal</code> package is still backwards compatible, we should
not (yet) worry about this: <code>rgdal</code> does the translation for the newer
GDAL 3 and PROJ &gt;= 6. Do know that, instead of <em>PROJ.4</em> strings, the
<em>WKT2</em> string is now used in R to better represent coordinate reference
systems (so it would best be incorporated in the EEA data source). Just
compare these:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic"># PROJ.4 string = old; used by PROJ 4</span>
<span style="color:#0a0">proj4string</span>(be10grid)  <span style="color:#aaa;font-style:italic"># or: be10grid@proj4string</span>
</code></pre></div><pre><code>## Warning in proj4string(be10grid): CRS object has comment, which is lost in
## output

## [1] &quot;+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs&quot;
</code></pre>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#aaa;font-style:italic"># WKT2 string = new and much better; used by PROJ &gt;= 6</span>
<span style="color:#0a0">wkt</span>(be10grid) %&gt;% cat  <span style="color:#aaa;font-style:italic"># or: be10grid@proj4string %&gt;% comment %&gt;% cat</span>
</code></pre></div><pre><code>## PROJCRS[&quot;ETRS89-extended / LAEA Europe&quot;,
##     BASEGEOGCRS[&quot;ETRS89&quot;,
##         DATUM[&quot;European Terrestrial Reference System 1989&quot;,
##             ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 LENGTHUNIT[&quot;metre&quot;,1]]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         ID[&quot;EPSG&quot;,4258]],
##     CONVERSION[&quot;Europe Equal Area 2001&quot;,
##         METHOD[&quot;Lambert Azimuthal Equal Area&quot;,
##             ID[&quot;EPSG&quot;,9820]],
##         PARAMETER[&quot;Latitude of natural origin&quot;,52,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8801]],
##         PARAMETER[&quot;Longitude of natural origin&quot;,10,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8802]],
##         PARAMETER[&quot;False easting&quot;,4321000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8806]],
##         PARAMETER[&quot;False northing&quot;,3210000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8807]]],
##     CS[Cartesian,2],
##         AXIS[&quot;northing (Y)&quot;,north,
##             ORDER[1],
##             LENGTHUNIT[&quot;metre&quot;,1]],
##         AXIS[&quot;easting (X)&quot;,east,
##             ORDER[2],
##             LENGTHUNIT[&quot;metre&quot;,1]],
##     USAGE[
##         SCOPE[&quot;Statistical analysis.&quot;],
##         AREA[&quot;Europe - European Union (EU) countries and candidates. Europe - onshore and offshore: Albania; Andorra; Austria; Belgium; Bosnia and Herzegovina; Bulgaria; Croatia; Cyprus; Czechia; Denmark; Estonia; Faroe Islands; Finland; France; Germany; Gibraltar; Greece; Hungary; Iceland; Ireland; Italy; Kosovo; Latvia; Liechtenstein; Lithuania; Luxembourg; Malta; Monaco; Montenegro; Netherlands; North Macedonia; Norway including Svalbard and Jan Mayen; Poland; Portugal including Madeira and Azores; Romania; San Marino; Serbia; Slovakia; Slovenia; Spain including Canary Islands; Sweden; Switzerland; Turkey; United Kingdom (UK) including Channel Islands and Isle of Man; Vatican City State.&quot;],
##         BBOX[24.6,-35.58,84.17,44.83]],
##     ID[&quot;EPSG&quot;,3035]]
</code></pre>
<p>We transform the 10 km x 10 km grid to the same CRS system:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">be10grid &lt;- <span style="color:#0a0">spTransform</span>(be10grid, crs_wgs84)
</code></pre></div><p>Now we are ready to spatially join (overlay) the
<code>SpatialPointsDataFrame</code> wth the 10 km x 10 km grid. This can be done
using <code>sp::over</code>. The first two arguments of the function give,
respectively, the geometry (locations) of the queries, and the layer
from which the geometries or attributes are queried. See <code>?sp::over</code>. In
this case, when x = “SpatialPoints” and y = “SpatialPolygonsDataFrame”,
it returns a <code>data.frame</code> of the second argument with row entries
corresponding to the first argument.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">invasive_be10grid &lt;- <span style="color:#0a0">over</span>(x = invasive_spatial, y = be10grid)
invasive_species_be10grid &lt;- <span style="color:#0a0">bind_cols</span>(invasive_species,
                                       invasive_be10grid)
</code></pre></div><p>To see what the result looks like, we can select the most relevant
variables and print it (first ten rows).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">invasive_species_be10grid %&gt;%
  <span style="color:#0a0">select</span>(species, <span style="color:#0a0">starts_with</span>(<span style="color:#a50">&#34;decimal&#34;</span>),
         eventDate, cellcode) %&gt;%
  <span style="color:#0a0">head</span>(<span style="color:#099">10</span>)
</code></pre></div><pre><code>## # A tibble: 10 × 5
##    species       decimalLatitude decimalLongitude eventDate           cellcode  
##    &lt;chr&gt;                   &lt;dbl&gt;            &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;     
##  1 Eriocheir si…            51.1             4.28 2008-09-17 00:00:00 10kmE392N…
##  2 Eriocheir si…            51.1             4.28 2008-06-03 00:00:00 10kmE392N…
##  3 Eriocheir si…            51.0             3.87 2008-03-20 00:00:00 10kmE389N…
##  4 Eriocheir si…            51.0             4.42 2008-07-03 00:00:00 10kmE393N…
##  5 Eriocheir si…            51.1             4.28 2008-09-17 00:00:00 10kmE392N…
##  6 Eriocheir si…            51.1             4.33 2008-04-10 00:00:00 10kmE392N…
##  7 Eriocheir si…            51.2             2.73 2008-03-13 00:00:00 10kmE381N…
##  8 Eriocheir si…            51.1             4.17 2008-03-19 00:00:00 10kmE391N…
##  9 Eriocheir si…            51.1             4.17 2008-03-19 00:00:00 10kmE391N…
## 10 Eriocheir si…            51.0             3.96 2008-10-28 00:00:00 10kmE389N…
</code></pre>
<h2 id="what-have-we-done">What have we done?<a href="#what-have-we-done" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>To wrap this up, we make a map that shows what we have done. We will use
the results obtained with the <code>sf</code> package.</p>
<p>First, we need to transform <code>invasive_be10grid_sf</code> back to WGS84 (the
background maps in leaflet are in WGS84) (<code>be10grid</code> is already in WGS84
format).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">invasive_be10grid_sf &lt;- invasive_be10grid_sf %&gt;%
  <span style="color:#0a0">st_transform</span>(crs = <span style="color:#099">4326</span>)
</code></pre></div><p>Zooming in on the point markers and hovering over a marker will show the
reference grid identifier for the grid cell as it is joined to spatial
points object <code>invasive_be10grid</code>. Clicking in a grid cell will bring up
a popup showing the reference grid identifier for the grid cell as it is
named in <code>be10grid</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">leaflet</span>(be10grid) %&gt;%
  <span style="color:#0a0">addTiles</span>() %&gt;%
  <span style="color:#0a0">addPolygons</span>(popup = ~cellcode) %&gt;%
  <span style="color:#0a0">addMarkers</span>(data = invasive_be10grid_sf,
             label = ~cellcode)
</code></pre></div><p><img src="index_files/figure-gfm/unnamed-chunk-19-1.png" alt=""><!-- --></p>
<p><em>Note: run the code to see the interactive map.</em></p>
</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
<span class='screen-reader-text'>Categories: </span><a class='category' href='/categories/r/'>r</a>, <a class='category' href='/categories/gis/'>gis</a></div>
<div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/gis/'>gis</a>, <a class='tag' href='/tags/r/'>r</a>, <a class='tag' href='/tags/maps/'>maps</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/tutorials/r_inbomd/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Applying the INBO corporate identity to bookdown documents</a>
    </div><div class='next-entry sep-before'>
      <a href='/tutorials/database_conventions/'>
        <span class='screen-reader-text'>Next post: </span>Database conventions (MS SQL Server)<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p><a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://inbo.github.io/tutorials/images/cc-by.svg" alt="CC BY 4.0"></a> &copy; 2018-2025 Research Institute for Nature and Forest (INBO) </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.c3bcf2df.js'></script><script src='/js/custom.js'></script>

</body>

</html>

