<!DOCTYPE html>
<html lang='en' dir='auto'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Learn some insights about mixed models based on a simple example'>
<meta name='theme-color' content='#c04384'>

<meta property='og:title' content='Mixed model formulation of a paired t-test • Hans Van Calster'>
<meta property='og:description' content='Learn some insights about mixed models based on a simple example'>
<meta property='og:url' content='/tutorials/r_paired_t_test/'>
<meta property='og:site_name' content='INBO Tutorials'>
<meta property='og:type' content='article'><meta property='article:section' content='tutorials'><meta property='article:tag' content='r'><meta property='article:tag' content='analysis'><meta property='article:tag' content='mixed model'><meta property='article:published_time' content='2020-07-01T00:00:00Z'/><meta property='article:modified_time' content='2020-07-01T00:00:00Z'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.88.1" />

  <title>Mixed model formulation of a paired t-test • Hans Van Calster</title>
  <link rel='canonical' href='/tutorials/r_paired_t_test/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.ab98e12b.css'><link rel='stylesheet' href='/css/custom.css'><style>
:root{--color-accent:#c04384;}
</style>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        {left: '\\[', right: '\\]', display: true},   
        {left: '$$', right: '$$', display: true},     
        {left: '\\(', right: '\\)', display: false},  
      ],
      throwOnError : false
    });
  });
</script>



</head>
<body class='page type-tutorials has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/'>
        <img src='/images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
      <a href='/'>
       
      </a>
    </h2>
    <div class='desc'>
    
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'> </h4>
  </header>

  <form action='/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='/'>Home</a></li><li class='item'>
  <a href='/articles/'>Articles</a></li><li class='item has-current'>
  <a href='/tutorials/'>Tutorials</a></li><li class='item'>
  <a href='/create_tutorial/'>Create tutorial</a></li><li class='item has-children'>
  <a href='/installation/'>Installation</a><button class='sub-menu-toggler'>
    <span class='screen-reader-text'>expand sub menu</span>
    <span class='sign'></span>
  </button>

  <ul class='sub-menu'><li class='item'>
  <a href='/installation/administrator/'>For admins</a></li><li class='item'>
  <a href='/installation/user/'>For users</a></li></ul></li><li class='item'>
  <a href='/categories/'>Categories</a></li><li class='item'>
  <a href='https://github.com/inbo/tutorials'>Repository</a></li></ul>
    </div>
  </nav>

</section><section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud no-shuffle'><li>
        <a href='/tags/analysis/' style='font-size:1.0632911392405062em'>analysis</a>
      </li><li>
        <a href='/tags/analysis-of-variance/' style='font-size:1em'>analysis of variance</a>
      </li><li>
        <a href='/tags/api/' style='font-size:1.0126582278481013em'>api</a>
      </li><li>
        <a href='/tags/bibliography/' style='font-size:1.0126582278481013em'>bibliography</a>
      </li><li>
        <a href='/tags/binning/' style='font-size:1em'>binning</a>
      </li><li>
        <a href='/tags/biodiversity/' style='font-size:1.0126582278481013em'>biodiversity</a>
      </li><li>
        <a href='/tags/biorad/' style='font-size:1em'>bioRad</a>
      </li><li>
        <a href='/tags/bookdown/' style='font-size:1.0126582278481013em'>bookdown</a>
      </li><li>
        <a href='/tags/brms/' style='font-size:1em'>brms</a>
      </li><li>
        <a href='/tags/checklist/' style='font-size:1.0253164556962024em'>checklist</a>
      </li><li>
        <a href='/tags/ci/' style='font-size:1.0126582278481013em'>ci</a>
      </li><li>
        <a href='/tags/co-variance/' style='font-size:1em'>co-variance</a>
      </li><li>
        <a href='/tags/coding-club/' style='font-size:1em'>coding club</a>
      </li><li>
        <a href='/tags/csl/' style='font-size:1.0126582278481013em'>csl</a>
      </li><li>
        <a href='/tags/data/' style='font-size:1.0253164556962024em'>data</a>
      </li><li>
        <a href='/tags/database/' style='font-size:1.0506329113924051em'>database</a>
      </li><li>
        <a href='/tags/de-trending/' style='font-size:1em'>de-trending</a>
      </li><li>
        <a href='/tags/development/' style='font-size:1.0126582278481013em'>development</a>
      </li><li>
        <a href='/tags/dplyr/' style='font-size:1em'>dplyr</a>
      </li><li>
        <a href='/tags/e-book/' style='font-size:1em'>e-book</a>
      </li><li>
        <a href='/tags/effectclass/' style='font-size:1.0253164556962024em'>effectclass</a>
      </li><li>
        <a href='/tags/endnote/' style='font-size:1em'>endnote</a>
      </li><li>
        <a href='/tags/etn/' style='font-size:1em'>etn</a>
      </li><li>
        <a href='/tags/explorative-data-analysis/' style='font-size:1em'>explorative data analysis</a>
      </li><li>
        <a href='/tags/frictionless/' style='font-size:1em'>frictionless</a>
      </li><li>
        <a href='/tags/gbif/' style='font-size:1.0126582278481013em'>gbif</a>
      </li><li>
        <a href='/tags/generalized-linear-regression/' style='font-size:1.0126582278481013em'>generalized linear regression</a>
      </li><li>
        <a href='/tags/ggplot2/' style='font-size:1.0126582278481013em'>ggplot2</a>
      </li><li>
        <a href='/tags/gis/' style='font-size:1.139240506329114em'>gis</a>
      </li><li>
        <a href='/tags/git/' style='font-size:1.1265822784810127em'>git</a>
      </li><li>
        <a href='/tags/gitbook/' style='font-size:1.0126582278481013em'>gitbook</a>
      </li><li>
        <a href='/tags/github/' style='font-size:1.0379746835443038em'>github</a>
      </li><li>
        <a href='/tags/google/' style='font-size:1.0126582278481013em'>google</a>
      </li><li>
        <a href='/tags/grids/' style='font-size:1em'>grids</a>
      </li><li>
        <a href='/tags/gwlogger/' style='font-size:1.0379746835443038em'>gwloggeR</a>
      </li><li>
        <a href='/tags/inbodb/' style='font-size:1.0253164556962024em'>inbodb</a>
      </li><li>
        <a href='/tags/inbomd/' style='font-size:1.0379746835443038em'>INBOmd</a>
      </li><li>
        <a href='/tags/inborutils/' style='font-size:1.0379746835443038em'>inborutils</a>
      </li><li>
        <a href='/tags/inla/' style='font-size:1.0253164556962024em'>INLA</a>
      </li><li>
        <a href='/tags/inlabru/' style='font-size:1em'>inlabru</a>
      </li><li>
        <a href='/tags/inlatools/' style='font-size:1.0253164556962024em'>inlatools</a>
      </li><li>
        <a href='/tags/installation/' style='font-size:1.1139240506329113em'>installation</a>
      </li><li>
        <a href='/tags/literature/' style='font-size:1.0506329113924051em'>literature</a>
      </li><li>
        <a href='/tags/maps/' style='font-size:1.0759493670886076em'>maps</a>
      </li><li>
        <a href='/tags/markdown/' style='font-size:1.0253164556962024em'>markdown</a>
      </li><li>
        <a href='/tags/mendeley/' style='font-size:1em'>mendeley</a>
      </li><li>
        <a href='/tags/mgrs/' style='font-size:1em'>mgrs</a>
      </li><li>
        <a href='/tags/mixed-model/' style='font-size:1.0632911392405062em'>mixed model</a>
      </li><li>
        <a href='/tags/mixed-models/' style='font-size:1em'>mixed models</a>
      </li><li>
        <a href='/tags/multivariate-statistics/' style='font-size:1em'>multivariate statistics</a>
      </li><li>
        <a href='/tags/n2khab/' style='font-size:1.0506329113924051em'>n2khab</a>
      </li><li>
        <a href='/tags/open-science/' style='font-size:1.0886075949367089em'>open science</a>
      </li><li>
        <a href='/tags/packages/' style='font-size:1.0379746835443038em'>packages</a>
      </li><li>
        <a href='/tags/pandoc/' style='font-size:1.0126582278481013em'>pandoc</a>
      </li><li>
        <a href='/tags/python/' style='font-size:1em'>python</a>
      </li><li>
        <a href='/tags/r/' style='font-size:2em'>r</a>
      </li><li>
        <a href='/tags/regression/' style='font-size:1em'>regression</a>
      </li><li>
        <a href='/tags/renv/' style='font-size:1em'>renv</a>
      </li><li>
        <a href='/tags/reports/' style='font-size:1.0126582278481013em'>reports</a>
      </li><li>
        <a href='/tags/rgbif/' style='font-size:1.0632911392405062em'>rgbif</a>
      </li><li>
        <a href='/tags/rmarkdown/' style='font-size:1.0253164556962024em'>rmarkdown</a>
      </li><li>
        <a href='/tags/rstudio/' style='font-size:1.0506329113924051em'>rstudio</a>
      </li><li>
        <a href='/tags/spatial/' style='font-size:1em'>spatial</a>
      </li><li>
        <a href='/tags/spreadsheet/' style='font-size:1em'>spreadsheet</a>
      </li><li>
        <a href='/tags/sql/' style='font-size:1em'>SQL</a>
      </li><li>
        <a href='/tags/stan/' style='font-size:1em'>stan</a>
      </li><li>
        <a href='/tags/styleguide/' style='font-size:1.0379746835443038em'>styleguide</a>
      </li><li>
        <a href='/tags/tidyverse/' style='font-size:1.0379746835443038em'>tidyverse</a>
      </li><li>
        <a href='/tags/uncertainty/' style='font-size:1.0126582278481013em'>uncertainty</a>
      </li><li>
        <a href='/tags/utm/' style='font-size:1em'>utm</a>
      </li><li>
        <a href='/tags/version-control/' style='font-size:1.1012658227848102em'>version control</a>
      </li><li>
        <a href='/tags/vignette/' style='font-size:1.481012658227848em'>vignette</a>
      </li><li>
        <a href='/tags/visual-markdown-editing/' style='font-size:1em'>visual markdown editing</a>
      </li><li>
        <a href='/tags/vmm/' style='font-size:1em'>vmm</a>
      </li><li>
        <a href='/tags/waterinfo/' style='font-size:1.0253164556962024em'>wateRinfo</a>
      </li><li>
        <a href='/tags/watina/' style='font-size:1.0253164556962024em'>watina</a>
      </li><li>
        <a href='/tags/webservice/' style='font-size:1.0379746835443038em'>webservice</a>
      </li><li>
        <a href='/tags/windows/' style='font-size:1em'>windows</a>
      </li><li>
        <a href='/tags/zenodo/' style='font-size:1em'>zenodo</a>
      </li><li>
        <a href='/tags/zotero/' style='font-size:1.0126582278481013em'>zotero</a>
      </li></ul>
</div>


</section>
<section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/inbo' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://facebook.com/INBOVlaanderen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Facebook account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section>
<section class='widget widget-build_time sep-after'>
  <p><small>Built on: Mon Mar 31 10:09:05 UTC 2025</small></p>
</section></div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button><div class='header-widgets'>
        <div class='container'>
    
    <style>.widget-breadcrumbs li:after{content:'\2f '}</style>
  <section class='widget widget-breadcrumbs sep-after'>
    <nav id='breadcrumbs'>
      <ol><li><a href='/'>Home</a></li><li><a href='/tutorials/'>Tutorials</a></li><li><span>Mixed model formulation of a paired t-test</span></li></ol>
    </nav>
  </section></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>INBO Tutorials</p><p class='desc site-desc'></p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Mixed model formulation of a paired t-test</h1>
      
<p class='desc'>Learn some insights about mixed models based on a simple example</p>


    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2020-07-01T00:00:00Z'>2020, Jul 01</time>
</span>

  <span class='byline'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
  <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
  
</svg>
<span class='screen-reader-text'> by </span><a href='/authors/hansvancalster'>Hans Van Calster</a></span>
  <br/>
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
4 mins read
</span>


  <span class="github-link">

    

        

        
            
        

        
            <a href='https://github.com/inbo/tutorials/edit/master/content/tutorials/r_paired_t_test/index.Rmd'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
Improve this page</a>
        

        
    
</span>

</div>


  </div>
</header>

  
  

  <div class='container entry-content'><h2 id="what-you-will-learn">What you will learn<a href="#what-you-will-learn" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>In this tutorial we explain the analogy between the paired t-test and
the corresponding mixed model formulation.</p>
<h2 id="used-packages">Used packages<a href="#used-packages" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">library</span>(knitr)
<span style="color:#0a0">library</span>(lme4)
<span style="color:#0a0">library</span>(tidyr)
<span style="color:#0a0">library</span>(broom)
<span style="color:#0a0">library</span>(DHARMa)
</code></pre></div><h2 id="data">Data<a href="#data" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<ul>
<li>plot: identifies paired measurements</li>
<li>response: measurement values</li>
<li>treatment: identifies two treatments (a and b)</li>
</ul>
<!-- end list -->
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">set.seed</span>(<span style="color:#099">124</span>)

paired_data &lt;- <span style="color:#0a0">data.frame</span>(
  plot = <span style="color:#0a0">rep</span>(<span style="color:#099">1</span>:<span style="color:#099">10</span>, <span style="color:#099">2</span>),
  response = <span style="color:#0a0">c</span>(<span style="color:#0a0">rnorm</span>(<span style="color:#099">10</span>), <span style="color:#0a0">rnorm</span>(<span style="color:#099">10</span>, <span style="color:#099">3</span>, <span style="color:#099">1.5</span>)),
  treatment = <span style="color:#0a0">rep</span>(<span style="color:#0a0">c</span>(<span style="color:#a50">&#34;a&#34;</span>, <span style="color:#a50">&#34;b&#34;</span>), each = <span style="color:#099">10</span>)
)

paired_data$treatment &lt;- <span style="color:#0a0">as.factor</span>(paired_data$treatment)
paired_data$plot &lt;- <span style="color:#0a0">as.factor</span>(paired_data$plot)

<span style="color:#aaa;font-style:italic"># in wide format</span>
paired_data_wide &lt;- <span style="color:#0a0">pivot_wider</span>(
  paired_data,
  id_cols = plot,
  names_from = treatment,
  values_from = response
)
</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">kable</span>(paired_data)
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">plot</th>
<th style="text-align:right">response</th>
<th style="text-align:center">treatment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">-1.3850706</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:right">0.0383232</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:right">-0.7630302</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:right">0.2123061</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:right">1.4255380</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:right">0.7444798</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:right">0.7002294</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:right">-0.2293546</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:right">0.1970939</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:right">1.2071538</td>
<td style="text-align:center">a</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">3.4775051</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:right">0.8643017</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:right">2.3923637</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:right">4.4930798</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:right">4.4382267</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:right">4.3771318</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:right">2.7735456</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:right">1.1653968</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:right">1.6967636</td>
<td style="text-align:center">b</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:right">1.4362720</td>
<td style="text-align:center">b</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">kable</span>(paired_data_wide)
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">plot</th>
<th style="text-align:right">a</th>
<th style="text-align:right">b</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">-1.3850706</td>
<td style="text-align:right">3.4775051</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:right">0.0383232</td>
<td style="text-align:right">0.8643017</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:right">-0.7630302</td>
<td style="text-align:right">2.3923637</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:right">0.2123061</td>
<td style="text-align:right">4.4930798</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:right">1.4255380</td>
<td style="text-align:right">4.4382267</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:right">0.7444798</td>
<td style="text-align:right">4.3771318</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:right">0.7002294</td>
<td style="text-align:right">2.7735456</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:right">-0.2293546</td>
<td style="text-align:right">1.1653968</td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:right">0.1970939</td>
<td style="text-align:right">1.6967636</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:right">1.2071538</td>
<td style="text-align:right">1.4362720</td>
</tr>
</tbody>
</table>
<h2 id="the-paired-t-test">The paired t-test<a href="#the-paired-t-test" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ttest &lt;- <span style="color:#0a0">with</span>(
  paired_data_wide,
  <span style="color:#0a0">t.test</span>(y = a, x = b, paired = <span style="color:#00a">TRUE</span>)
)
</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">kable</span>(<span style="color:#0a0">tidy</span>(ttest))
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right">estimate</th>
<th style="text-align:right">statistic</th>
<th style="text-align:right">p.value</th>
<th style="text-align:right">parameter</th>
<th style="text-align:right">conf.low</th>
<th style="text-align:right">conf.high</th>
<th style="text-align:left">method</th>
<th style="text-align:left">alternative</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">2.496692</td>
<td style="text-align:right">5.157401</td>
<td style="text-align:right">0.0005972</td>
<td style="text-align:right">9</td>
<td style="text-align:right">1.401584</td>
<td style="text-align:right">3.591799</td>
<td style="text-align:left">Paired t-test</td>
<td style="text-align:left">two.sided</td>
</tr>
</tbody>
</table>
<h2 id="alternative-but-equivalent-formulation-via-a-lineair-mixed-model">Alternative, but equivalent formulation via a lineair mixed model<a href="#alternative-but-equivalent-formulation-via-a-lineair-mixed-model" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Plot identifies the paired measurements. A random effect for plot allows
us to take this dependence into account.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mm &lt;- <span style="color:#0a0">lmer</span>(response ~ treatment + (<span style="color:#099">1</span> | plot),
  data = paired_data
)
</code></pre></div><p>The parameter estimates for treatment b gives the difference compared to
treatment a (= intercept), accounting for the paired nature of the data.
This difference is the same as the <em>estimate</em> for the paired t-test.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">kable</span>(<span style="color:#0a0">tidy</span>(mm))
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:center">term</th>
<th style="text-align:right">estimate</th>
<th style="text-align:right">std.error</th>
<th style="text-align:right">statistic</th>
<th style="text-align:left">group</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">(Intercept)</td>
<td style="text-align:right">0.2147669</td>
<td style="text-align:right">0.3711260</td>
<td style="text-align:right">0.578690</td>
<td style="text-align:left">fixed</td>
</tr>
<tr>
<td style="text-align:center">treatmentb</td>
<td style="text-align:right">2.4966918</td>
<td style="text-align:right">0.4840988</td>
<td style="text-align:right">5.157401</td>
<td style="text-align:left">fixed</td>
</tr>
<tr>
<td style="text-align:center">sd_(Intercept).plot</td>
<td style="text-align:right">0.4534165</td>
<td style="text-align:right">NA</td>
<td style="text-align:right">NA</td>
<td style="text-align:left">plot</td>
</tr>
<tr>
<td style="text-align:center">sd_Observation.Residual</td>
<td style="text-align:right">1.0824778</td>
<td style="text-align:right">NA</td>
<td style="text-align:right">NA</td>
<td style="text-align:left">Residual</td>
</tr>
</tbody>
</table>
<p>The anova output gives us a test for treatment in terms of an F-test.
The t-test is based on the t-statistic. Both test statistics are
related: (F = t^2).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">kable</span>(<span style="color:#0a0">anova</span>(mm))
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th style="text-align:right">npar</th>
<th style="text-align:right">Sum Sq</th>
<th style="text-align:right">Mean Sq</th>
<th style="text-align:right">F value</th>
</tr>
</thead>
<tbody>
<tr>
<td>treatment</td>
<td style="text-align:right">1</td>
<td style="text-align:right">31.16735</td>
<td style="text-align:right">31.16735</td>
<td style="text-align:right">26.59879</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">anova</span>(mm)[[<span style="color:#a50">&#34;F value&#34;</span>]]
</code></pre></div><pre><code>## [1] 26.59879
</code></pre>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">unname</span>(ttest[[<span style="color:#a50">&#34;statistic&#34;</span>]])^2
</code></pre></div><pre><code>## [1] 26.59879
</code></pre>
<p>We can calculate the confidence interval given as part of the t-test
output, based on the t-distributie.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">difference &lt;- <span style="color:#0a0">data.frame</span>(
  diff = <span style="color:#0a0">summary</span>(mm)$coefficients[2, <span style="color:#099">1</span>],
  se = <span style="color:#0a0">summary</span>(mm)$coefficients[2, <span style="color:#099">2</span>]
)

difference$lwr &lt;- difference$diff - <span style="color:#0a0">qt</span>(p = <span style="color:#099">1</span> - <span style="color:#099">0.05</span> / <span style="color:#099">2</span>, df = <span style="color:#099">9</span>) * difference$se
difference$upr &lt;- difference$diff + <span style="color:#0a0">qt</span>(p = <span style="color:#099">1</span> - <span style="color:#099">0.05</span> / <span style="color:#099">2</span>, df = <span style="color:#099">9</span>) * difference$se
</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">kable</span>(difference)
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:right">diff</th>
<th style="text-align:right">se</th>
<th style="text-align:right">lwr</th>
<th style="text-align:right">upr</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">2.496692</td>
<td style="text-align:right">0.4840988</td>
<td style="text-align:right">1.401584</td>
<td style="text-align:right">3.591799</td>
</tr>
</tbody>
</table>
<p>The recommended procedure to calculate a confidence interval for
parameters of mixed models is, however, to use the `<code>confint</code> function.
Either an approximation (Wald statistic) or a profile likelihood
confidence interval can be calculated. These intervals are slightly
different from the t-distribution based confidence interval.</p>
<p>Via profile likelihood:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">kable</span>(<span style="color:#0a0">confint</span>(mm, parm = <span style="color:#a50">&#34;treatmentb&#34;</span>, method = <span style="color:#a50">&#34;profile&#34;</span>))
</code></pre></div><pre><code>## Computing profile confidence intervals ...
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:right">2.5 %</th>
<th style="text-align:right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr>
<td>treatmentb</td>
<td style="text-align:right">1.505743</td>
<td style="text-align:right">3.487635</td>
</tr>
</tbody>
</table>
<p>Wald-type confidence interval:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#0a0">kable</span>(<span style="color:#0a0">confint</span>(mm, parm = <span style="color:#a50">&#34;treatmentb&#34;</span>, method = <span style="color:#a50">&#34;Wald&#34;</span>))
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th style="text-align:right">2.5 %</th>
<th style="text-align:right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr>
<td>treatmentb</td>
<td style="text-align:right">1.547876</td>
<td style="text-align:right">3.445508</td>
</tr>
</tbody>
</table>
<p>Were model assuptions met? Yes.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">DHARMa::<span style="color:#0a0">plotQQunif</span>(mm)
</code></pre></div><p><img src="index_files/figure-gfm/unnamed-chunk-2-1.png" alt=""><!-- --></p>
<h2 id="take-home-message">Take home message<a href="#take-home-message" class="anchor"><svg height="22px" viewBox="0 0 24 24" width="22px"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The standard paired t-test is typically used to test for a significant
differences between two paired treatments. We can formulate the test in
terms of a mixed model. The benefit is that we get more informative
model output, which allows us among other things to check if model
assumptions were met. For the paired t-test, one assumption is that the
paired differences between treatments follow a normal distribution. When
these assumptions are not met, the flexibility of the mixed model
framework allows to improve the model to better fit the requirements for
the data at hand. For instance, one can choose from a number of
parametric statistical distributions that are likely to fit the data
(for counts, the Poisson or negative binomial distribution can be
chosen, and for binary or proportional data, a binomial distribution is
an obvious choice).</p>
</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
<span class='screen-reader-text'>Categories: </span><a class='category' href='/categories/r/'>r</a>, <a class='category' href='/categories/statistics/'>statistics</a></div>
<div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/r/'>r</a>, <a class='tag' href='/tags/analysis/'>analysis</a>, <a class='tag' href='/tags/mixed-model/'>mixed model</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/tutorials/r_fixed_random/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Same variable in fixed and random effects</a>
    </div><div class='next-entry sep-before'>
      <a href='/tutorials/r_zoom_in_ggplot/'>
        <span class='screen-reader-text'>Next post: </span>&#39;Zoom in&#39; on `ggplot2` figures<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p><a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://inbo.github.io/tutorials/images/cc-by.svg" alt="CC BY 4.0"></a> &copy; 2018-2025 Research Institute for Nature and Forest (INBO) </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.c3bcf2df.js'></script><script src='/js/custom.js'></script>

</body>

</html>

